(this["webpackJsonpguandan-app"]=this["webpackJsonpguandan-app"]||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var a=n(131),r=(n(96),n(5)),c=n(15),l=n(74),s=n.n(l),o=n(0),i=n.n(o),u=n(7),d=n(9),b=n(92),j=n(47),h=n(57),g=n(129),p=n(2);function y(e){return requestAnimationFrame((()=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{e()}))}))}))}const f=e=>{let t=e.children,n=e.style,a=e.timeout,l=Object(h.a)(e,["children","style","timeout"]);const s=Object(o.useState)(new g.a.Value(0)),i=Object(c.a)(s,2),u=i[0];i[1];return Object(p.jsx)(j.Transition,Object(r.a)(Object(r.a)({timeout:a+300,onEntering:()=>{y((()=>{g.a.timing(u,{toValue:1,duration:a}).start()}))},onExiting:()=>{y((()=>{g.a.timing(u,{toValue:0,duration:a}).start()}))}},l),{},{children:Object(p.jsx)(g.a.View,{style:[{opacity:u},n],children:t})}))};f.defaultProps={appear:!0,enter:!0,mountOnEnter:!0,unmountOnExit:!0};var O=n(133),x=n(35),k=n(94);const m={H:{value:"H",label:"\u2665",text:"\u2665",color:"red"},D:{value:"D",label:"\u2666",text:"\u2666",color:"red"},S:{value:"S",label:"\u2660",text:"\u2660",color:"black"},C:{value:"C",label:"\u2663",text:"\u2663",color:"black"}},R={B:{value:"B",label:"",text:"B",color:"black"},R:{value:"R",label:"",text:"R",color:"red"}},w=[R.B,R.R],A=Object(r.a)(Object(r.a)({},m),R),S=[m.H,m.S,m.C,m.D];const E={S:"C",C:"D",D:"H",H:void 0};const C=12,v=13,T=14,I=15,L=[1,2,3,4,5,6,7,8,9,10,11,12,v,T,I],P={1:{label:"A",text:"A",naturalRank:1},2:{label:"2",text:"2",naturalRank:2},3:{label:"3",text:"3",naturalRank:3},4:{label:"4",text:"4",naturalRank:4},5:{label:"5",text:"5",naturalRank:5},6:{label:"6",text:"6",naturalRank:6},7:{label:"7",text:"7",naturalRank:7},8:{label:"8",text:"8",naturalRank:8},9:{label:"9",text:"9",naturalRank:9},10:{label:"10",text:"10",naturalRank:10},11:{label:"J",text:"J",naturalRank:11},12:{label:"Q",text:"Q",naturalRank:12},[v]:{label:"K",text:"K",naturalRank:v},[T]:{label:"Joker",text:"J",naturalRank:T},[I]:{label:"Joker",text:"J",naturalRank:I}};const B=L.slice(0,L.length-2);const H=u.a.create({card:{width:74,height:100,backgroundColor:"white",borderColor:"black",borderWidth:2,borderRadius:4},cardLarge:{width:100,height:134},cardStacked:{marginRight:-52,marginBottom:-52},cardStackedLarge:{marginRight:-68,marginBottom:-68},cardLabel:{fontFamily:"monospace",fontSize:16,lineHeight:16,textAlign:"center",width:20,marginTop:4,fontWeight:"bold"},cardLabelLarge:{fontSize:24,lineHeight:24,width:30},cardCuteImage:{position:"absolute",left:"calc(50% - 20px)",top:"calc(50% - 20px)",width:40,height:40},cardCuteImageLarge:{width:56,height:56,left:"calc(50% - 28px)",top:"calc(50% - 28px)"},overlayWhenDisabled:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.3)"}});function U({rank:e,suit:t,isStacked:n,disabled:a,style:r,large:c}){const l=P[e],s=A[t];return Object(p.jsxs)(d.a,{style:[H.card,c&&H.cardLarge,n&&H.cardStacked,n&&c&&H.cardStackedLarge,r],children:[Object(p.jsxs)(b.a,{style:[H.cardLabel,c&&H.cardLabelLarge,{color:s.color}],children:["10"===l.label?l.label:l.label.split("").join("\n"),"\n",s.label]}),Object(p.jsx)(k.a,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAQAAAAm93DmAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjAhUINB2XPPnXAAAEaElEQVRIx52WWWxUZRTHf3e2TmfrdJlaSWlRlkK6AA1BiCQNWzRIUBACwS1Go2LE0JASwaSVh8qDxroEhBcJFBMTbNQGFRIftAqoIBpKY9vU0EUK0xY6bYdZ78zxodLZ7nTh/3bv+c7vnO+c8333wv0olwp0M3EoZBMZaa0KB/mFnJkAd+BhW1rrKr1b6aV4JsDXHWJpZYGmLcdwdqvMGqRM21W7Es71bCmjFpuG7cWV62qwmrDMJMP63fKPLA3yhjHZsjynt1nuyJIA67VdDZpvc208TJ3ppZrbV2jHRTYWwIuP/c/O3kCQLCO50wfqsDsI4aSwaPiEy5eX77SaDeAPDQcHsjv4kJWYdem6rAXUK47f2M5tqtg3byEF2DAihDO93KKV83xFB5Rg5e506mdgQ0bXajkuNyQqWopIjxyVR/3GM1RNPd5ZHJx/56gMy1QakPekyE0N1slwLuXkOvWPKWHjisrPsiLIYZzpcNmceira9//yoLSLOwHgl0tyMwnaIWtUjmjOKwYOrY30TSxtEpdsE1+c8xdikxcknIJcHuKtWC1jRX1szq53dYUTj0bCWBJqbqOYwpQuLKDe+EA1q1KaofxQnxA5KJfFLaoEREQVv4hEZFD8ml3fKzSRmQjcXO7v0VjcJPslJEekJmWr8bomxSOsid+yjk2Pm4sSIrj5Hcihidf4iJI0Z3RcC1ntYKMS96bA2vZ9UtRjsklCEpW3BdknYRG5LuckkibHE6K/SNZ4bwEKXbOSLz8HrRzCyRnycRPEwHE6WZsmxzKyi4cKGLkHzHdZks/6RsY4Thd1VLCbXRRymnfQpwEWkGcfirt/nlwV9mpspFmWyYCIXJC5skJOJkxlogZlsY+qWFN8PjWgEbecMFcAJzbe57nkyYiTD1+YQAzoHvAOaSwrYi0f0EcjD7KUydTPkIfBGPDfwe5rGst07EXhCb7kzSk+IX/h6eLWxGMGNLya5vbrlQZpFnXSeycoW4TaxBBVDw23yf3qguTfojIRmMHne6bII50C8rxwOHWiluX1NN8XsFHs7SxKKaseXll8988Z41pknocd2q0yUfeIf7ofgHH9KKVjVKc9QJg5UDry9aRXVUxBOSVzh9iNkUlkYHtu9x7pTDNE9xSRq/Ky2L08g5IISE42SmegKlByji4cZGsG93KJjzlGDn2BsU/oS84oWZmG/APY2ck3zKeCcopwYATCeOjmKq10E6CRUjba+mdzcSqgJdOZw2VG1R2GCvaOqS3OrMxsvRlUv++Ox++o+tTsppYeKjGm7lADqFMMn/Fdf+Ts+Z0FZrUzVD0QwooJCOElK3S6t6RJ9bQ2lFaaIiDJ7rGS5lNJMS7mKFuVrOgNbuqWWAzeUfqQCTcFhSKzPaRGr+vnPG38VXp/oo1Rhujnb9pQ44EL2cwiCnBiwoYBK1HAhDmlbRECKIgSJChRvHi5TQ8tfEuQpKbrMJFBBhb02NEBFo3fDJVhBAjgJ8xdQoQI3zP+B8PxaLIJz6YTAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTAyLTIxVDA4OjUyOjI5KzAwOjAwIu73FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wMi0yMVQwODo1MjoyOSswMDowMFOzT6gAAAAASUVORK5CYII="},style:[H.cardCuteImage,c&&H.cardCuteImageLarge]}),a&&Object(p.jsx)(d.a,{style:H.overlayWhenDisabled})]})}const F=({cards:e,hands:t,style:n,large:a})=>{const c=a?68:52;return Object(p.jsxs)(x.a,{style:n,contentContainerStyle:{flexWrap:"wrap",flexDirection:"row",padding:0,paddingRight:c+0,paddingBottom:c+0},children:[!!e&&e.map(((e,t)=>Object(p.jsx)(U,Object(r.a)(Object(r.a)({},e),{},{isStacked:!0,large:a}),e.rank+e.suit+t))),!!t&&t.map(((e,t)=>{const n=e.map(((e,t)=>Object(p.jsx)(U,Object(r.a)(Object(r.a)({},e),{},{isStacked:!0,large:a}),e.rank+e.suit+t)));return t>0?Object(p.jsx)(d.a,{style:{flexDirection:"row",flexWrap:"nowrap",marginRight:13},children:n},t):Object(p.jsx)(d.a,{style:{flexDirection:"row",flexWrap:"wrap",marginRight:13,maxWidth:"100%"},children:n},t)}))]})},W=L.map((e=>e===T?[{rank:e,suit:"B"}]:e===I?[{rank:e,suit:"R"}]:S.map((t=>({rank:e,suit:t.value}))))).reduce(((e,t)=>(e.push(...t),e)),[]);function G(e,t){return e.rank!==t.rank?e.rank-t.rank:e.suit<t.suit?-1:e.suit===t.suit?0:1}function z(){return function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}return e}([...W,...W]).slice(0,27).sort(G)}function N(e,t){return e.filter((e=>0===G(e,t))).length<2}const D=u.a.create({divider:{height:2,backgroundColor:"black",marginHorizontal:10}});function J(){return Object(p.jsx)(d.a,{style:D.divider})}const K=e=>{let t=e.style,n=e.titleStyle,a=e.title,c=e.disabled,l=Object(h.a)(e,["style","titleStyle","title","disabled"]);return Object(p.jsx)(O.a,Object(r.a)(Object(r.a)({style:[{backgroundColor:c?Q.disabled.background:Q.button.background,borderRadius:2,paddingVertical:8,paddingHorizontal:4,alignItems:"center",justifyContent:"center"},t],disabled:c},l),{},{children:Object(p.jsx)(b.a,{style:[{color:c?Q.disabled.text:"white",textAlign:"center"},n],children:a})}))},M="rgb(33, 150, 243)",V={0:"black",4:"rgb(161, 161, 161)",6:"rgb(223, 223, 223)",8:"white"},Q={disabled:{background:V[6],text:V[4]},button:{background:M}};function _(){const e=function(e=0){const t=Object(o.useState)(e),n=Object(c.a)(t,2),a=n[0],r=n[1],l=Object(o.useCallback)((()=>r((e=>e+1))),[r]),s=Object(o.useCallback)((()=>r((e=>e-1))),[r]);return{value:a,increase:l,decrease:s}}(1);return{rank:e.value,incRank:e.increase,decRank:e.decrease}}const Z=u.a.create({incDecButton:{flex:2,minWidth:80,maxWidth:200,margin:6},actionButton:{flex:1,minWidth:80,maxWidth:150,margin:6},buttonTitle:{fontSize:20},buttonTitleSmall:{fontSize:20}}),Y=e=>Object(p.jsxs)(d.a,{children:[Object(p.jsxs)(d.a,{style:{flexDirection:"row",justifyContent:"center",alignContent:"center"},children:[Object(p.jsx)(K,{onPress:e.decRank,disabled:e.rank<=1,title:"<",style:Z.incDecButton,titleStyle:Z.buttonTitle}),Object(p.jsx)(K,{onPress:e.incRank,title:">",disabled:e.rank>=15,style:Z.incDecButton,titleStyle:Z.buttonTitle})]}),Object(p.jsxs)(d.a,{style:{flexDirection:"row",justifyContent:"center",alignContent:"center"},children:[Object(p.jsx)(K,{onPress:e.randomCards,title:"\u968f\u673a\u53d1\u724c",disabled:e.numberOfCards>0,style:Z.actionButton,titleStyle:Z.buttonTitleSmall}),Object(p.jsx)(K,{onPress:e.clearCards,title:"\u6e05\u9664",disabled:0===e.numberOfCards,style:Z.actionButton,titleStyle:Z.buttonTitle}),Object(p.jsx)(K,{onPress:e.deleteLastCard,title:"\u5220\u9664",disabled:0===e.numberOfCards,style:Z.actionButton,titleStyle:Z.buttonTitle})]})]}),q=e=>{const t=e.rank===T||e.rank===I?w:S;return Object(p.jsx)(p.Fragment,{children:t.map((t=>{const n={suit:t.value,rank:e.rank},a=N(e.cards,n);return Object(p.jsx)(O.a,{onPress:()=>e.addCard(n),disabled:!a,children:Object(p.jsx)(U,{suit:t.value,rank:e.rank,disabled:!a,style:{margin:3},large:e.large})},t.value)}))})};function X({cards:e,addCard:t,clearCards:n,randomCards:a,deleteLastCard:r,windowSize:c}){const l=_(),s=l.rank,o=l.incRank,i=l.decRank;return Object(p.jsxs)(d.a,{style:{flex:1},children:[Object(p.jsx)(d.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(p.jsx)(F,{cards:e,style:{height:60,padding:6},large:"BIG"===c})}),Object(p.jsx)(J,{}),Object(p.jsx)(b.a,{style:{fontSize:14,margin:4},children:"\u70b9\u51fb\u6251\u514b\u724c\u6dfb\u52a0\uff0c\u76ee\u524d\u5df2\u6709".concat(e.length,"\u5f20\u724c")}),Object(p.jsx)(x.a,{style:{height:"SMALL"===c?110:150,flexGrow:0},contentContainerStyle:{flex:1,justifyContent:"center"},horizontal:!0,children:Object(p.jsx)(q,{cards:e,addCard:t,rank:s,large:"BIG"===c})}),Object(p.jsx)(Y,{numberOfCards:e.length,clearCards:n,randomCards:a,deleteLastCard:r,rank:s,incRank:o,decRank:i})]})}var $=n(134);function ee({rank:e,setRank:t}){return Object(p.jsx)(d.a,{style:{flexDirection:"row"},children:Object(p.jsxs)(b.a,{style:{fontSize:22,marginHorizontal:6},children:["\u5f53\u524d\u6253",Object(p.jsx)($.a,{selectedValue:e,onValueChange:e=>t(e),children:B.map((e=>Object(p.jsx)($.a.Item,{label:P[e].label,value:e},e)))})," ",Object(p.jsxs)(b.a,{style:{color:A.H.color},children:[A.H.label,P[e].label]}),"\u662f\u767e\u642d"]})})}const te=u.a.create({container:{padding:10},borderBox:{borderWidth:2,borderColor:"black"}}),ne=({rank:e,setRank:t,cards:n,clearCards:a,addCard:r,randomCards:c,deleteLastCard:l,navigation:s,windowSize:i})=>{const u=Object(o.useCallback)((()=>{s.navigate("Result")}),[]);return Object(p.jsxs)(o.Fragment,{children:[Object(p.jsx)(d.a,{style:[te.container,{flexDirection:"row",height:40,justifyContent:"center",alignItems:"center"}],children:Object(p.jsx)(ee,{rank:e,setRank:t})}),Object(p.jsx)(J,{}),Object(p.jsx)(d.a,{style:{flex:1},children:Object(p.jsx)(X,{cards:n,addCard:r,clearCards:a,randomCards:c,deleteLastCard:l,windowSize:i})}),Object(p.jsx)(d.a,{style:[te.container,{justifyContent:"center",padding:6}],children:Object(p.jsx)(K,{title:"\u5f00\u59cb\u62c6\u724c",onPress:u,style:{height:60},titleStyle:{fontSize:28}})})]})},ae=i.a.memo(ne);var re=function({screenProps:e,navigation:t}){return Object(p.jsx)(ae,Object(r.a)(Object(r.a)({},e),{},{navigation:t}))},ce=n(45),le=n.n(ce),se=n(65),oe=n(132);function ie(){return(ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ue(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var de=o.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),be=o.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"});function je(e,t){let n=e.title,a=e.titleId,r=ue(e,["title","titleId"]);return o.createElement("svg",ie({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?o.createElement("title",{id:a},n):null,de,be)}const he=o.forwardRef(je);n.p;function ge(){return(ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function pe(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ye=o.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),fe=o.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"});function Oe(e,t){let n=e.title,a=e.titleId,r=pe(e,["title","titleId"]);return o.createElement("svg",ge({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?o.createElement("title",{id:a},n):null,ye,fe)}const xe=o.forwardRef(Oe);n.p;function ke({natural:e,context:t}){return{natural:e,power:t.getOrder(e)}}function me(e){return{rank:e.rank.natural,suit:e.suit}}const Re=e=>Object(p.jsx)(O.a,{style:[{width:40,flexDirection:"row",justifyContent:"center",alignItems:"center"},e.style],onPress:e.onClose,children:Object(p.jsx)(he,{})}),we=({strategyResult:e,rank:t,windowSize:n})=>Object(p.jsx)(p.Fragment,{children:e&&("loading"===e?Object(p.jsx)(b.a,{style:{fontSize:20},children:"\u8ba1\u7b97\u4e2d"}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(d.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(p.jsx)(b.a,{style:{fontSize:18,flexShrink:0,marginRight:20},children:"\u6700\u5c11".concat(e.plans[0].score,"\u624b\u724c")}),Object(p.jsxs)(b.a,{style:{textAlignVertical:"center"},children:[Object(p.jsx)(xe,{style:{width:19,height:19,verticalAlign:"top"}}),"\u5927\u5c0f\u738b\u3001\u70b8\u5f39\u7b970\u624b\uff0c\u5176\u4ed6\u724c\u578b\u7b971\u624b"]})]}),Object(p.jsx)(d.a,{children:(()=>{const t=e.plans.length-5;return Object(p.jsxs)(p.Fragment,{children:[e.plans.slice(0,5).map(((e,t)=>Object(p.jsx)(F,{hands:e.plays.map((e=>e.cards.map(me))),style:{margin:6},large:"BIG"===n},t))),t>0&&"\u8fd8\u6709".concat(t,"\u79cd\u65b9\u6848")]})})()})]}))}),Ae=Object(o.memo)(we),Se=({strategyResult:e,rank:t,onClose:n,windowSize:a})=>Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(d.a,{style:{flexDirection:"row",justifyContent:"flex-end",alignContent:"center"},children:[Object(p.jsx)(d.a,{style:{flex:1},children:Object(p.jsx)(b.a,{style:{fontSize:20,padding:4,textAlign:"center"},children:"\u62c6\u724c\u7b56\u7565\u8ba1\u7b97\u7ed3\u679c"})}),Object(p.jsx)(Re,{onClose:n,style:{position:"absolute",right:0,height:"100%"}})]}),Object(p.jsx)(J,{}),Object(p.jsx)(x.a,{style:[te.container,{flex:2}],children:e.map((e=>Object(p.jsx)(Ae,{strategyResult:e,rank:t,windowSize:a})))})]});var Ee=i.a.memo(Se);const Ce=1e7;let ve;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE=1]="SINGLE",e[e.PAIR=2]="PAIR",e[e.TRIPLE=3]="TRIPLE",e[e.FULL_HOUSE=4]="FULL_HOUSE",e[e.STRAIGHT=5]="STRAIGHT",e[e.TUBE=6]="TUBE",e[e.PLATE=7]="PLATE",e[e.STRAIGHT_FLUSH=8]="STRAIGHT_FLUSH",e[e.BOMB_N_TUPLE=9]="BOMB_N_TUPLE",e[e.FOUR_JOKER=10]="FOUR_JOKER"}(ve||(ve={}));const Te={[ve.STRAIGHT_FLUSH]:ve.BOMB_N_TUPLE,[ve.BOMB_N_TUPLE]:ve.PLATE,[ve.PLATE]:ve.TUBE,[ve.TUBE]:ve.STRAIGHT,[ve.STRAIGHT]:ve.PAIR,[ve.PAIR]:ve.TRIPLE,[ve.TRIPLE]:void 0};const Ie={rank:1,suit:"S",type:ve.STRAIGHT_FLUSH};function Le(e){const t=function(e){const t=e+1;if(!(t>I))return t}(e.rank);if(null!=t)return Object(r.a)(Object(r.a)({},e),{},{rank:t});if(e.suit){console.assert(e.type===ve.STRAIGHT_FLUSH);const t=(n=e.suit,E[n]);if(null!=t)return Object(r.a)(Object(r.a)({},e),{},{rank:1,suit:t})}var n;const a=(c=e.type,Te[c]);var c;return null!=a?Object(r.a)(Object(r.a)({},e),{},{rank:1,type:a,suit:void 0}):void 0}function Pe({cards:e,collectPlan:t,context:n}){Ye({cardsByRank:Be(e,n),context:{collectPlan:t,game:n,debug:false}})}function Be(e,t){const n={};return e.forEach((e=>{const a=t.isWildCard(e)?0:e.rank.natural;n[a]=n[a]||[],n[a].push(e)})),n}function He(e,t,n=1){console.assert(n>=1);const a=e[t]||[];if(n<=a.length){const r=a.slice(0,n);return e[t]=a.slice(n),r}const r=e[0],c=n-a.length;if(!r||c>r.length)return;const l=a.concat(r.slice(0,c));return e[t]=[],e[0]=r.slice(c),l}function Ue(e,t,n){const a=e[t]||[],r=a.findIndex((e=>e.suit===n));if(r>=0)return e[t]=[...a],e[t].splice(r,1),a[r];const c=e[0]||[];return c.length>0?(e[0]=c.slice(1),c[0]):void 0}const Fe=e=>({cards:t,nowRank:n,plan:a,context:c})=>{const l=Object(r.a)({},t),s=He(l,n,e);if(null==s)return;const o={type:2===e?ve.PAIR:3===e?ve.TRIPLE:ve.BOMB_N_TUPLE,rank:c.game.getOrder(n),cardCount:e};return{cardsByRank:l,plan:{score:a.score+(e>3?0:1),plays:a.plays.concat({playRank:o,cards:s})}}},We=({cardCount:e,length:t,playType:n})=>({cards:a,nowRank:c,plan:l,context:s})=>{s.debug&&console.log("playCardSequence: ".concat(JSON.stringify(a),", ").concat(c));const o=c+t-1;if(o>14)return;let i=Object(r.a)({},a),u={cards:[],playRank:{type:n,rank:c}};for(let t=c;t<=o;++t){const n=He(i,14==t?1:t,e);if(null==n)return;u.cards.push(...n)}return{cardsByRank:i,plan:{score:l.score+1,plays:l.plays.concat(u)}}},Ge=Fe(2),ze=Fe(3),Ne=Fe(4),De=Fe(5),Je=Fe(6),Ke=Fe(7),Me=Fe(8),Ve=We({cardCount:1,length:5,playType:ve.STRAIGHT}),Qe=We({cardCount:2,length:3,playType:ve.TUBE}),_e=We({cardCount:3,length:2,playType:ve.PLATE}),Ze={[ve.PAIR]:[Ge],[ve.TRIPLE]:[ze,({cards:e,nowRank:t,plan:n,context:a})=>{const r=ze({cards:e,nowRank:t,plan:n,context:a});if(null==r)return;const c=r.cardsByRank,l=r.plan,s=l.plays.findIndex((e=>e.playRank.type===ve.PAIR));if(s<0)return;const o=l.plays[l.plays.length-1],i=l.plays[s];return l.plays=l.plays.slice(0,s).concat(l.plays.slice(s+1,l.plays.length-1)),l.plays.push({playRank:{type:ve.FULL_HOUSE,rank:o.playRank.rank},cards:o.cards.concat(i.cards)}),l.score=l.score-1,{plan:l,cardsByRank:c}}],[ve.BOMB_N_TUPLE]:[Ne,De,Je,Ke,Me],[ve.STRAIGHT]:[Ve],[ve.TUBE]:[Qe],[ve.PLATE]:[_e],[ve.STRAIGHT_FLUSH]:[({cards:e,nowRank:t,nowSuit:n,plan:a,context:c})=>{if(c.debug&&console.log("playStraightFlush: ".concat(JSON.stringify(e),", ").concat(t,", ").concat(n)),!n)return void console.assert(n);const l=t+5-1;if(l>14)return;let s=Object(r.a)({},e),o={cards:[],playRank:{type:ve.STRAIGHT_FLUSH,rank:t}};for(let r=t;r<=l;++r){const e=Ue(s,14==r?1:r,n);if(null==e)return;o.cards.push(e)}return{cardsByRank:s,plan:{score:a.score+0,plays:a.plays.concat(o)}}}]};function Ye({cardsByRank:e,plan:t={score:0,plays:[]},now:n=Ie,context:a}){var c;a.debug&&console.log(ve[n.type],n.rank,n.suit),null===(c=Ze[n.type])||void 0===c||c.forEach((c=>{const l=c({nowRank:n.rank,nowSuit:n.suit,cards:e,plan:t,context:a});null!=l&&Ye(Object(r.a)(Object(r.a)({},l),{},{now:n,context:a}))}));const l=Le(n);null!=l?Ye({now:l,cardsByRank:e,plan:t,context:a}):a.collectPlan(function(e,t){const n=Object(r.a)(Object(r.a)({},e),{},{plays:[...e.plays]});return Object.entries(t).forEach((([e,t])=>{t&&(n.score+=t.length,t.forEach((e=>{n.plays.push({playRank:{type:ve.SINGLE,rank:e.rank.power},cards:[e]})})))})),n}(t,e))}function qe(e){switch(e){case I:return 14;case T:return 13;case 1:return 12;default:return e-2}}class Xe{constructor(e){this.mainRank=void 0,this.mainRank=e}getOrder(e){if(e==I)return 14;if(e==T)return 13;if(e==this.mainRank)return 12;{const t=qe(e);return t>qe(this.mainRank)?t-1:t}}isWildCard(e){return e.rank.natural===this.mainRank&&"H"===e.suit}}const $e=e=>e.score,et=1e100,tt=e=>{const t={};return e.plays.forEach((e=>{t[e.playRank.type]=t[e.playRank.type]||0,t[e.playRank.type]+=function(e){const t=e.playRank;switch(t.type){case ve.SINGLE:switch(t.rank){case 14:return-1;case 13:return-.8;default:return nt({x:0,y:1},{x:12,y:-.2},t.rank)}case ve.PAIR:switch(t.rank){case 14:return-1;case 13:return-.95;default:return t.rank>=9?nt({x:9,y:0},{x:12,y:-.9},t.rank):nt({x:9,y:0},{x:0,y:1},t.rank)}case ve.TRIPLE:return t.rank>=9?nt({x:9,y:0},{x:12,y:-1},t.rank):nt({x:9,y:0},{x:0,y:1},t.rank);case ve.FULL_HOUSE:return t.rank>=8?nt({x:8,y:0},{x:12,y:-1},t.rank):nt({x:8,y:0},{x:0,y:1},t.rank);case ve.STRAIGHT:return t.rank>=7?nt({x:7,y:0},{x:10,y:-1},t.rank):nt({x:7,y:0},{x:1,y:.8},t.rank);case ve.TUBE:return t.rank>=8?nt({x:8,y:0},{x:C,y:-1},t.rank):nt({x:8,y:0},{x:1,y:.5},t.rank);case ve.PLATE:return t.rank>=6?nt({x:6,y:0},{x:v,y:-1},t.rank):nt({x:6,y:0},{x:1,y:.3},t.rank);case ve.STRAIGHT_FLUSH:case ve.BOMB_N_TUPLE:case ve.FOUR_JOKER:return-1;default:throw new Error("Unknown play rank type")}}(e)})),t[ve.SINGLE]=at(t[ve.SINGLE],-3,et),t[ve.PAIR]=at(t[ve.PAIR],-2,6),t[ve.TRIPLE]=at(t[ve.TRIPLE],-.3,6),t[ve.FULL_HOUSE]=at(t[ve.FULL_HOUSE],-1.3,3),t[ve.STRAIGHT]=at(t[ve.STRAIGHT],-.8,1.5),t[ve.TUBE]=at(t[ve.TUBE],-.3,1),t[ve.PLATE]=at(t[ve.PLATE],-.2,.3),Object.values(t).reduce(((e,t)=>(e||0)+(t||0)))||0};function nt(e,t,n){return(t.y-e.y)/(t.x-e.x)*(n-e.x)+e.y}function at(e,t,n){return null==e?0:e<t?t:e>n?n:e}function rt({cards:e,mainRank:t,morePlans:n=!0,scorer:a="HANDS"}){const r=new Xe(t),c=e.map((e=>function(e,t){return{rank:ke({natural:e.rank,context:t}),suit:e.suit}}(e,r))),l="HEURISTICS"===a?tt:$e;if(n){const e=lt({scorer:l});Pe({cards:c,collectPlan:e.collectPlan,context:r});const t=e.getBestPlans();if(0==t.length)throw new Error("No plan found");return t}{const e=ct({scorer:l});Pe({cards:c,collectPlan:e.collectPlan,context:r});const t=e.getBestPlan();if(null==t)throw new Error("No plan found");return[t]}}const ct=({scorer:e=$e}={})=>{let t,n=et,a=0;return{collectPlan:r=>{const c=e(r);if(r.score=c,(null==t||c<=n)&&(t=r,n=c),++a,a>Ce)throw new Error("too many plans")},getBestPlan:()=>t}},lt=({scorer:e=$e}={})=>{let t=[],n=et,a=0;return{collectPlan:r=>{if(++a,a>Ce)throw new Error("too many plans");const c=e(r);r.score=c,0===t.length?(t.push(r),n=c):c<n?(t=[r],n=c):c===n&&t.push(r)},getBestPlans:()=>t}};var st=function({screenProps:e,navigation:t}){const n=e.rank,a=e.cards,r=e.windowSize,l={cards:a,mainRank:n,morePlans:!0,scorer:"HEURISTICS"},s=Object(o.useState)(!1),i=Object(c.a)(s,2),u=i[0],d=i[1];Object(o.useEffect)((()=>{const e=setTimeout((()=>{d(!0)}),500);return()=>{clearTimeout(e)}}),[]);const b=Object(oe.a)(["calc",l],Object(se.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rt(l));case 1:case"end":return e.stop()}}),e)}))),{enabled:u}),j=b.status,h=b.data,g={cards:a,mainRank:n,morePlans:!0,scorer:"HANDS"},y=Object(oe.a)(["calc",g],Object(se.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rt(g));case 1:case"end":return e.stop()}}),e)}))),{enabled:"success"==j}),f=y.status,O=y.data;let x=["loading"];return"success"==j&&(x=[{title:"\u4ef7\u503c\u7b56\u7565",plans:h}],"loading"==f?x.push("loading"):"success"==f&&x.push({title:"\u624b\u6570\u7b56\u7565",plans:O})),Object(p.jsx)(Ee,{strategyResult:x,rank:n,windowSize:r,onClose:t.goBack})};const ot="NOT_FOUND",it={path:"/not-found",title:"Page Not Found"};var ut=n(43);function dt(){const e=ut.a.get("window"),t=e.width,n=e.height;return t>=720&&n>=720?"BIG":"SMALL"}var bt=n(130),jt=n(93);const ht=u.a.create({absoluteChild:{position:"absolute",left:0,top:0,right:0,bottom:0}}),gt={Home:re,Result:st},pt=({route:e,navigation:t,screenProps:n,style:a})=>Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(j.TransitionGroup,{children:Object.entries(gt).map((([r,c])=>r!==e?null:Object(p.jsx)(f,{style:[ht.absoluteChild,a],timeout:300,children:Object(p.jsx)(c,{screenProps:n,navigation:t})},r)))})}),yt=function(e,t){const n=Object(r.a)(Object(r.a)({},e),{},{routes:Object(r.a)(Object(r.a)({},e.routes),{},{[ot]:it})});function a(){const e=t.location.pathname;return e.startsWith(n.base)?(a=e.substring(n.base.length)).endsWith("/")?a.substring(0,a.length-1):a:n.base+it.path;var a}function l(e){const t=Object.entries(n.routes).find((([t,n])=>n.path===e))||[ot,it],a=Object(c.a)(t,2);return{route:a[0],routeConfig:a[1]}}return function(){const e=Object(o.useState)(l(a()).route),r=Object(c.a)(e,2),s=r[0],i=r[1];Object(o.useEffect)((()=>t.listen((function(e,t){i(l(a()).route)}))),[i]),Object(o.useEffect)((()=>{window.document.title=n.routes[s].title}),[]);const u=Object(o.useCallback)(((e,{replace:a=!1}={})=>{e=n.routes[e]?e:ot;const r=n.routes[e];a?t.replace(n.base+r.path):t.push(n.base+r.path)}),[n,it]);return{route:s,title:n.routes[s].title,navigation:{navigate:u,goBack:t.goBack}}}}({base:"/poker-guandan-strategy",defaultRoute:"Home",routes:{Home:{path:"",title:"\u63bc\u86cb\u62c6\u724c\u8ba1\u7b97\u5668"},Result:{path:"/result",title:"\u63bc\u86cb\u62c6\u724c\u8ba1\u7b97\u5668"}}},s()());function ft(){const e=Object(o.useState)(1),t=Object(c.a)(e,2),n=t[0],a=t[1],l=function(){const e=Object(o.useState)([]),t=Object(c.a)(e,2),n=t[0],a=t[1];return{cards:n,clearCards:Object(o.useCallback)((()=>a([])),[a]),addCard:Object(o.useCallback)((e=>a((t=>t.concat(e)))),[a]),randomCards:Object(o.useCallback)((()=>a(z())),[a]),deleteLastCard:Object(o.useCallback)((()=>a((e=>e.slice(0,e.length-1)))),[a])}}(),s=(()=>{const e=Object(o.useState)([]),t=Object(c.a)(e,2);return{strategyResult:t[0],setResult:t[1]}})(),i=yt(),u=i.route,j=i.navigation,h=function(){const e=Object(o.useState)(dt),t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((()=>{function e(){a(dt())}return ut.a.addEventListener("change",e),()=>ut.a.removeEventListener("change",e)}),[a]),n}();return Object(p.jsx)(d.a,{style:{flex:1,backgroundColor:"lightblue",height:"100%"},children:Object(p.jsxs)(d.a,{style:{height:"100%"},children:[Object(p.jsx)(b.a,{style:{fontSize:14},children:"\u63bc\u86cb\u62c6\u724c\u8ba1\u7b97\u5668"}),Object(p.jsx)(d.a,{style:{flex:1},children:Object(p.jsx)(pt,{route:u,screenProps:Object(r.a)(Object(r.a)(Object(r.a)({rank:n,setRank:a},l),s),{},{windowSize:h}),navigation:j,style:{flex:1}})})]})})}const Ot=new bt.a;var xt=()=>Object(p.jsx)(jt.a,{client:Ot,children:Object(p.jsx)(ft,{})});const kt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function mt(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}a.a.registerComponent("App",(()=>xt)),a.a.runApplication("App",{rootTag:document.getElementById("root")}),function(e){if("serviceWorker"in navigator){if(new URL("/poker-guandan-strategy",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="".concat("/poker-guandan-strategy","/service-worker.js");kt?(!function(e,t){fetch(e).then((n=>{const a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):mt(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):mt(t,e)}))}}({onSuccess:()=>console.log("service worker loaded successfully"),onUpdate:()=>console.log("service worker is updated")}),function(){const e=window.document.getElementById("wechat-guidance");if(e){const t=e.parentNode;t&&t.removeChild(e)}}()},96:function(e,t,n){}},[[126,1,2]]]);
//# sourceMappingURL=main.39d80a96.chunk.js.map