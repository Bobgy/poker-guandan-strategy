{"version":3,"sources":["Fade.tsx","strategy/models/Suite.ts","strategy/models/const.ts","Card.tsx","imgs/neko-40x40.png","common/cardUtils.ts","Divider.tsx","MyButton.tsx","CardsChooser.tsx","RankChooser.tsx","strategy/models/Rank.ts","strategy/models/Card.ts","strategy/models/Play.ts","strategy/iterate.ts","strategy/const.ts","strategy/utils.ts","strategy/models/GameContext.ts","strategy/strategy.ts","styles.tsx","Home.tsx","icons/close.svg","icons/info.svg","SolutionVisualization.tsx","ResultPage.tsx","useRouterState.ts","useWindowSize.tsx","App.tsx","useCardState.ts","useResultState.ts","serviceWorker.ts","index.tsx"],"names":["delay","fn","requestAnimationFrame","Fade","children","style","timeout","restProps","useState","Animated","Value","fadeAnim","onEntering","timing","toValue","duration","start","onExiting","View","opacity","defaultProps","appear","enter","mountOnEnter","unmountOnExit","SUIT_NORMAL","H","value","label","color","D","S","C","SUIT_JOKER","B","R","SUITS_JOKER","SUIT","SUITS","NEXT_SUIT","undefined","K","BLACK_JOKER","RED_JOKER","NATURAL_RANKS","NATURAL_RANK","naturalRank","2","3","4","5","6","7","8","9","10","NATURAL_RANKS_WITHOUT_JOKERS","slice","length","styles","StyleSheet","create","card","width","height","backgroundColor","borderColor","borderWidth","borderRadius","cardLarge","cardStacked","marginRight","marginBottom","cardStackedLarge","cardLabel","fontFamily","fontSize","lineHeight","textAlign","marginTop","fontWeight","cardLabelLarge","cardCuteImage","position","left","top","cardCuteImageLarge","overlayWhenDisabled","right","bottom","Card","rank","suit","isStacked","disabled","large","rankDef","suitDef","Text","split","join","Image","source","uri","CardDeck","cards","hands","stackedCardMargin","ScrollView","contentContainerStyle","flexWrap","flexDirection","padding","paddingRight","paddingBottom","map","index","hand","handID","handNode","cardID","maxWidth","ALL_CARDS_ONE_DECK","reduce","res","push","cardCompare","a","b","generateRandomHands","i","j","Math","floor","random","x","shuffle","sort","canIAddCard","cardToAdd","filter","divider","marginHorizontal","Divider","MyButton","titleStyle","title","TouchableOpacity","theme","background","button","paddingVertical","paddingHorizontal","alignItems","justifyContent","text","palette","0","useRankState","defaultValue","setValue","increase","useCallback","valueNow","decrease","useIncDecState","incRank","decRank","controlStyles","incDecButton","flex","minWidth","margin","actionButton","buttonTitle","buttonTitleSmall","ControlPanel","props","alignContent","onPress","randomCards","numberOfCards","clearCards","deleteLastCard","AddCardPanel","suits","canIAddThisCard","addCard","CardsChooser","windowSize","flexGrow","horizontal","RankChooser","setRank","Picker","selectedValue","onValueChange","itemValue","Item","makeRank","natural","context","power","getOrder","cardRawToText","cardToCardRaw","PlayType","NEXT_PLAY_TYPE","STRAIGHT_FLUSH","BOMB_N_TUPLE","PLATE","TUBE","STRAIGHT","PAIR","TRIPLE","ITERATOR_STATE_START","type","nextIteratorState","now","next","nextRank","console","assert","nextSuit","nextType","playType","iteratePlans","collectPlan","gameContext","iterateImp","cardsByRank","organize","game","debug","organized","forEach","isWildCard","takeCard","count","rankCards","taken","wildCards","wildCardsNeeded","concat","takeCardBySuit","findIndex","splice","playCardsOfTheSameRank","n","nowRank","plan","newCards","playRank","cardCount","score","plays","playCardSequence","log","JSON","stringify","end","newCardsByRank","play","playPair","playTriple","playBomb4","playBomb5","playBomb6","playBomb7","playBomb8","playStraight","playTube","playPlate","PLAY_TYPE_FUNC","result","newPlan","pairIndex","triplePlay","pairPlay","FULL_HOUSE","nowSuit","func","resultPlan","Object","entries","_","SINGLE","playRestOfCardsAsSingles","getUsualPowerRank","GameContext","constructor","mainRank","this","usualRank","calc","rawCards","rawCard","raw","parseCardRaw","bestPlanCollector","makeBestPlanCollector","bestPlan","getBestPlan","Error","commonStyles","container","borderBox","HomePage","strategyResult","setResult","navigation","useValueEstimator","setUseValueEstimator","handleSolutionCalcButton","setTimeout","plans","navigate","use","isReady","MemoedHomePage","React","memo","HomePageWrapper","screenProps","_extends","assign","target","arguments","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","fill","d","_ref3","SvgClose","_ref","svgRef","titleId","xmlns","viewBox","ref","id","ForwardRef","SvgInfo","CloseWindowButton","onClose","SolutionWindow","flexShrink","textAlignVertical","verticalAlign","hiddenMoreSolutions","planIndex","MemoedSolutionWindow","SolutionVisualization","ResultPage","goBack","NOT_FOUND","NOT_FOUND_CONFIG","path","calcWindowSize","Dimensions","get","absoluteChild","routes","Home","Result","AppNavigator","route","currentRoute","RouteComponent","useRouterState","providedRoutesConfig","history","routesConfig","getCurrentPath","pathNowRaw","location","pathname","startsWith","base","substring","endsWith","match","find","routeConfig","setRoute","useEffect","listen","action","window","document","routeToDispatch","replace","routeMatched","createBrowserRouterHook","process","defaultRoute","createHistory","App","cardStateProps","setCards","cardsNow","useCardState","resultProps","useResultState","size","setSize","handleWindowSizeChange","addEventListener","removeEventListener","useWindowSize","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","catch","error","AppRegistry","registerComponent","runApplication","rootTag","getElementById","URL","href","origin","fetch","response","contentType","headers","status","ready","unregister","reload","checkValidServiceWorker","guidanceNode","parentNode","removeChild","removeWechatGuidance"],"mappings":"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","file":"static/js/main.5a57dd58.chunk.js","sourcesContent":["import React, { useState, FunctionComponent } from 'react'\nimport { Animated, StyleProp, ViewStyle } from 'react-native'\nimport { Transition } from 'react-transition-group'\nimport { TransitionProps } from 'react-transition-group/Transition'\n\ninterface FadeProps extends TransitionProps {\n  style?: StyleProp<ViewStyle>\n  timeout: number\n}\n\nfunction delay(fn: () => void) {\n  return requestAnimationFrame(() => {\n    // current frame\n    requestAnimationFrame(() => {\n      // next frame, react updated dom\n      requestAnimationFrame(() => {\n        // the third frame, start animation in the first idle frame\n        fn()\n      })\n    })\n  })\n}\n\n// animation may be delayed by react rendering\n// keep components mounted for some extra time to ensure animation finishes before components are unmounted\nconst EXTRA_TIMEOUT = 300\n\nexport const Fade: FunctionComponent<FadeProps> = ({\n  children,\n  style,\n  timeout,\n  ...restProps\n}) => {\n  const [fadeAnim, _] = useState(new Animated.Value(0))\n\n  return (\n    <Transition\n      timeout={timeout + EXTRA_TIMEOUT}\n      onEntering={() => {\n        // start fading in from the next frame (react is rendering in current frame, so animation would be laggy if started immediately)\n        delay(() => {\n          Animated.timing(fadeAnim, { toValue: 1, duration: timeout }).start()\n        })\n      }}\n      onExiting={() => {\n        // start fading out after a delay\n        delay(() => {\n          Animated.timing(fadeAnim, {\n            toValue: 0,\n            duration: timeout,\n          }).start()\n        })\n      }}\n      {...restProps}\n    >\n      <Animated.View\n        style={[\n          {\n            opacity: fadeAnim,\n          },\n          style,\n        ]}\n      >\n        {children}\n      </Animated.View>\n    </Transition>\n  )\n}\nFade.defaultProps = {\n  appear: true,\n  enter: true,\n  mountOnEnter: true,\n  unmountOnExit: true,\n}\n","export type Suit = 'S' | 'C' | 'D' | 'H'\nexport type SuitRedJoker = 'R'\nexport type SuitBlackJoker = 'B'\nexport type SuitJoker = SuitRedJoker | SuitBlackJoker\nexport type AllSuit = Suit | SuitRedJoker | SuitBlackJoker\nexport type SuiteMetadata<S> = {\n  value: S\n  label: string\n  color: string\n}\nexport const SUIT_NORMAL: Record<Suit, SuiteMetadata<Suit>> = {\n  H: {\n    value: 'H',\n    label: '♥',\n    color: 'red',\n  },\n  D: {\n    value: 'D',\n    label: '♦',\n    color: 'red',\n  },\n  S: {\n    value: 'S',\n    label: '♠',\n    color: 'black',\n  },\n  C: {\n    value: 'C',\n    label: '♣',\n    color: 'black',\n  },\n} as const\nexport const SUIT_JOKER: Record<SuitJoker, SuiteMetadata<SuitJoker>> = {\n  B: {\n    // black joker\n    value: 'B',\n    label: '',\n    color: 'black',\n  },\n  R: {\n    // red joker\n    value: 'R',\n    label: '',\n    color: 'red',\n  },\n} as const\nexport const SUITS_JOKER = [SUIT_JOKER.B, SUIT_JOKER.R]\nexport const SUIT = {\n  ...SUIT_NORMAL,\n  ...SUIT_JOKER,\n}\nexport const SUITS = [\n  SUIT_NORMAL.H,\n  SUIT_NORMAL.S,\n  SUIT_NORMAL.C,\n  SUIT_NORMAL.D,\n]\nexport const SUIT_VALUES = ['S', 'C', 'D', 'H']\nexport function parseSuit(\n  suit: string,\n): [undefined, string] | [Suit, undefined] {\n  if (!SUIT_VALUES.includes(suit)) {\n    return [\n      undefined,\n      `Suit should be one of ${SUIT_VALUES}, but found ${suit}.`,\n    ]\n  }\n  return [suit as Suit, undefined]\n}\n\nconst NEXT_SUIT = {\n  S: 'C',\n  C: 'D',\n  D: 'H',\n  H: undefined,\n} as const\nexport const SUIT_START: Suit = 'S'\nexport function getNextSuit(suit: Suit): Suit | undefined {\n  return NEXT_SUIT[suit]\n}\n","import { AllSuit, parseSuit, Suit, SuitBlackJoker, SuitRedJoker } from './Suite'\n\nexport type J = 11\nexport const J = 11\nexport type Q = 12\nexport const Q = 12\nexport type K = 13\nexport const K = 13\nexport type A = 1\nexport const A = 1\nexport type BlackJoker = 14\nexport const BLACK_JOKER = 14\nexport type RedJoker = 15\nexport const RED_JOKER = 15\nexport type NaturalRank =\n  | A\n  | 2\n  | 3\n  | 4\n  | 5\n  | 6\n  | 7\n  | 8\n  | 9\n  | 10\n  | J\n  | Q\n  | K\n  | BlackJoker\n  | RedJoker\nexport const NATURAL_RANK_MIN = A\nexport const NATURAL_RANK_MAX = RED_JOKER\nexport type NaturalRankWithoutJokers = Exclude<\n  NaturalRank,\n  BlackJoker | RedJoker\n>\nexport const NATURAL_RANKS = [\n  A,\n  2,\n  3,\n  4,\n  5,\n  6,\n  7,\n  8,\n  9,\n  10,\n  J,\n  Q,\n  K,\n  BLACK_JOKER,\n  RED_JOKER,\n] as const\ninterface RankMetadata {\n  label: string\n  naturalRank: NaturalRank\n}\nexport const NATURAL_RANK: Record<NaturalRank, RankMetadata> = {\n  [A]: { label: 'A', naturalRank: A },\n  2: { label: '2', naturalRank: 2 },\n  3: { label: '3', naturalRank: 3 },\n  4: { label: '4', naturalRank: 4 },\n  5: { label: '5', naturalRank: 5 },\n  6: { label: '6', naturalRank: 6 },\n  7: { label: '7', naturalRank: 7 },\n  8: { label: '8', naturalRank: 8 },\n  9: { label: '9', naturalRank: 9 },\n  10: { label: '10', naturalRank: 10 },\n  [J]: { label: 'J', naturalRank: J },\n  [Q]: { label: 'Q', naturalRank: Q },\n  [K]: { label: 'K', naturalRank: K },\n  [BLACK_JOKER]: { label: 'Joker', naturalRank: BLACK_JOKER },\n  [RED_JOKER]: { label: 'Joker', naturalRank: RED_JOKER },\n} as const\nexport function nextRank(rank: NaturalRank): NaturalRank | undefined {\n  const next = rank + 1\n  if (next > RED_JOKER) {\n    return undefined\n  }\n  return next as NaturalRank\n}\nexport const NATURAL_RANKS_WITHOUT_JOKERS: NaturalRankWithoutJokers[] = NATURAL_RANKS.slice(\n  0,\n  NATURAL_RANKS.length - 2,\n) as any\n/**\n * There are 15 different cards. In one game play, they will have a power\n * rank depending on main rank.\n */\nexport type PowerRank =\n  | 0\n  | 1\n  | 2\n  | 3\n  | 4\n  | 5\n  | 6\n  | 7\n  | 8\n  | 9\n  | 10\n  | 11\n  | 12\n  | 13\n  | 14\nexport const POWER_RANK_MAX = 14\nexport type CardRaw =\n  | {\n      // Natural rank, from [A, K] maps to [1, 13]\n      // 14 is kept for A's order rank.\n      // Black Joker is 15, Red Joker is 16\n      rank: NaturalRankWithoutJokers\n      suit: Suit\n    }\n  | {\n      rank: BlackJoker\n      suit: SuitBlackJoker\n    }\n  | {\n      rank: RedJoker\n      suit: SuitRedJoker\n    }\nexport type CardRawLoose = { rank: NaturalRank; suit: AllSuit }\n\nexport function parseRawCards(text: string): CardRaw[] {\n  const cards: CardRaw[] = []\n  for (let i = 0; i < text.length; ) {\n    if (text[i] === 'R') {\n      if (text[i + 1] !== 'J') {\n        throw new Error(\n          `R should be followed by J -- red joker in ${text}, position ${i}`,\n        )\n      }\n      cards.push({ rank: RED_JOKER, suit: 'R' })\n      i += 2\n    } else if (text[i] === 'B') {\n      if (text[i + 1] !== 'J') {\n        throw new Error(\n          `B should be followed by J -- black joker in ${text}, position ${i}`,\n        )\n      }\n      cards.push({ rank: BLACK_JOKER, suit: 'B' })\n      i += 2\n    } else {\n      const parsedSuit = parseSuit(text[i])\n      const [_, error] = parsedSuit\n      if (parsedSuit[1] != null) {\n        throw new Error(`${error}, in ${text}, position ${i}`)\n      }\n      const [suit] = parsedSuit\n      if (text[i + 1] === '1' && text[i + 2] === '0') {\n        cards.push({ rank: 10, suit })\n        i += 3\n      } else if (text[i + 1] === 'A') {\n        cards.push({ rank: A, suit })\n        i += 2\n      } else if (text[i + 1] === 'J') {\n        cards.push({ rank: J, suit })\n        i += 2\n      } else if (text[i + 1] === 'Q') {\n        cards.push({ rank: Q, suit })\n        i += 2\n      } else if (text[i + 1] === 'K') {\n        cards.push({ rank: K, suit })\n        i += 2\n      } else {\n        const rank = text[i + 1].charCodeAt(0) - '0'.charCodeAt(0)\n        if (rank < 2 || rank > 9) {\n          throw new Error(\n            `Rank should be in range [2, 9], but found ${rank}, in ${text}, position ${\n              i + 1\n            }`,\n          )\n        }\n        cards.push({ rank: rank as NaturalRankWithoutJokers, suit })\n        i += 2\n      }\n    }\n  }\n  return cards\n}\n","import React from 'react'\nimport {\n  Image,\n  ScrollView,\n  StyleProp,\n  StyleSheet,\n  Text,\n  View,\n  ViewStyle,\n} from 'react-native'\nimport nekoImg from './imgs/neko-40x40.png'\nimport {\n  CardRaw,\n  CardRawLoose,\n  NATURAL_RANK,\n  NATURAL_RANKS,\n} from './strategy/models/const'\nimport { Suit, SUIT } from './strategy/models/Suite'\n\nconst STACKED_CARD_MARGIN = 52\nconst STACKED_CARD_MARGIN_LARGE = 68\n\nconst styles = StyleSheet.create({\n  card: {\n    width: 74,\n    height: 100,\n    backgroundColor: 'white',\n    borderColor: 'black',\n    borderWidth: 2,\n    borderRadius: 4,\n  },\n  cardLarge: {\n    width: 100,\n    height: 134,\n  },\n  cardStacked: {\n    marginRight: -STACKED_CARD_MARGIN,\n    marginBottom: -STACKED_CARD_MARGIN,\n  },\n  cardStackedLarge: {\n    marginRight: -STACKED_CARD_MARGIN_LARGE,\n    marginBottom: -STACKED_CARD_MARGIN_LARGE,\n  },\n  cardLabel: {\n    fontFamily: 'monospace',\n    fontSize: 16,\n    lineHeight: 16,\n    textAlign: 'center',\n    width: 20,\n    marginTop: 4,\n    fontWeight: 'bold',\n  },\n  cardLabelLarge: {\n    fontSize: 24,\n    lineHeight: 24,\n    width: 30,\n  },\n  cardCuteImage: {\n    position: 'absolute',\n    left: 'calc(50% - 20px)',\n    top: 'calc(50% - 20px)',\n    width: 40,\n    height: 40,\n  },\n  cardCuteImageLarge: {\n    width: 56,\n    height: 56,\n    left: 'calc(50% - 28px)',\n    top: 'calc(50% - 28px)',\n  },\n  overlayWhenDisabled: {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    backgroundColor: 'rgba(0, 0, 0, 0.3)',\n  },\n})\n\nexport function Card({\n  rank,\n  suit,\n  isStacked,\n  disabled,\n  style,\n  large,\n}: CardRawLoose & {\n  isStacked?: boolean\n  disabled?: boolean\n  style?: StyleProp<ViewStyle>\n  large?: boolean\n}) {\n  const rankDef = NATURAL_RANK[rank]\n  const suitDef = SUIT[suit as Suit] // TODO: fix type force cast\n  return (\n    <View\n      style={[\n        styles.card,\n        large && styles.cardLarge,\n        isStacked && styles.cardStacked,\n        isStacked && large && styles.cardStackedLarge,\n        style,\n      ]}\n    >\n      <Text\n        style={[\n          styles.cardLabel,\n          large && styles.cardLabelLarge,\n          { color: suitDef.color },\n        ]}\n      >\n        {rankDef.label === '10'\n          ? rankDef.label\n          : rankDef.label.split('').join('\\n')}\n        {'\\n'}\n        {suitDef.label}\n      </Text>\n      <Image\n        source={{ uri: nekoImg }}\n        style={[styles.cardCuteImage, large && styles.cardCuteImageLarge]}\n      />\n      {disabled && <View style={styles.overlayWhenDisabled} />}\n    </View>\n  )\n}\n\nconst HAND_MARGIN = 13\nconst CONTAINER_PADDING = 0\n\ninterface CardDeckProps {\n  cards?: CardRaw[]\n  hands?: CardRaw[][]\n  style?: StyleProp<ViewStyle>\n  large?: boolean\n}\nexport const CardDeck: React.FunctionComponent<CardDeckProps> = ({\n  cards,\n  hands,\n  style,\n  large,\n}) => {\n  const stackedCardMargin = large\n    ? STACKED_CARD_MARGIN_LARGE\n    : STACKED_CARD_MARGIN\n\n  return (\n    <ScrollView\n      style={style}\n      contentContainerStyle={{\n        flexWrap: 'wrap',\n        flexDirection: 'row',\n        padding: CONTAINER_PADDING,\n        paddingRight: stackedCardMargin + CONTAINER_PADDING, // cancel margin of hands\n        paddingBottom: stackedCardMargin + CONTAINER_PADDING,\n      }}\n    >\n      {!!cards &&\n        cards.map((card, index) => (\n          <Card\n            key={card.rank + card.suit + index}\n            {...card}\n            isStacked\n            large={large}\n          />\n        ))}\n      {!!hands &&\n        hands.map((hand, handID) => {\n          const handNode = hand.map((card, cardID) => (\n            <Card\n              key={card.rank + card.suit + cardID}\n              {...card}\n              isStacked\n              large={large}\n            />\n          ))\n\n          if (handID > 0) {\n            // no wrapping\n            return (\n              <View\n                style={{\n                  flexDirection: 'row',\n                  flexWrap: 'nowrap',\n                  marginRight: HAND_MARGIN,\n                }}\n                key={handID}\n              >\n                {handNode}\n              </View>\n            )\n          } else {\n            // initial hand can be long, allow wrapping as normal\n            return (\n              <View\n                style={{\n                  flexDirection: 'row',\n                  flexWrap: 'wrap',\n                  marginRight: HAND_MARGIN,\n                  maxWidth: '100%', // set max width to enable wrapping\n                }}\n                key={handID}\n              >\n                {handNode}\n              </View>\n            )\n          }\n        })}\n    </ScrollView>\n  )\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAQAAAAm93DmAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjAhUINB2XPPnXAAAEaElEQVRIx52WWWxUZRTHf3e2TmfrdJlaSWlRlkK6AA1BiCQNWzRIUBACwS1Go2LE0JASwaSVh8qDxroEhBcJFBMTbNQGFRIftAqoIBpKY9vU0EUK0xY6bYdZ78zxodLZ7nTh/3bv+c7vnO+c8333wv0olwp0M3EoZBMZaa0KB/mFnJkAd+BhW1rrKr1b6aV4JsDXHWJpZYGmLcdwdqvMGqRM21W7Es71bCmjFpuG7cWV62qwmrDMJMP63fKPLA3yhjHZsjynt1nuyJIA67VdDZpvc208TJ3ppZrbV2jHRTYWwIuP/c/O3kCQLCO50wfqsDsI4aSwaPiEy5eX77SaDeAPDQcHsjv4kJWYdem6rAXUK47f2M5tqtg3byEF2DAihDO93KKV83xFB5Rg5e506mdgQ0bXajkuNyQqWopIjxyVR/3GM1RNPd5ZHJx/56gMy1QakPekyE0N1slwLuXkOvWPKWHjisrPsiLIYZzpcNmceira9//yoLSLOwHgl0tyMwnaIWtUjmjOKwYOrY30TSxtEpdsE1+c8xdikxcknIJcHuKtWC1jRX1szq53dYUTj0bCWBJqbqOYwpQuLKDe+EA1q1KaofxQnxA5KJfFLaoEREQVv4hEZFD8ml3fKzSRmQjcXO7v0VjcJPslJEekJmWr8bomxSOsid+yjk2Pm4sSIrj5Hcihidf4iJI0Z3RcC1ntYKMS96bA2vZ9UtRjsklCEpW3BdknYRG5LuckkibHE6K/SNZ4bwEKXbOSLz8HrRzCyRnycRPEwHE6WZsmxzKyi4cKGLkHzHdZks/6RsY4Thd1VLCbXRRymnfQpwEWkGcfirt/nlwV9mpspFmWyYCIXJC5skJOJkxlogZlsY+qWFN8PjWgEbecMFcAJzbe57nkyYiTD1+YQAzoHvAOaSwrYi0f0EcjD7KUydTPkIfBGPDfwe5rGst07EXhCb7kzSk+IX/h6eLWxGMGNLya5vbrlQZpFnXSeycoW4TaxBBVDw23yf3qguTfojIRmMHne6bII50C8rxwOHWiluX1NN8XsFHs7SxKKaseXll8988Z41pknocd2q0yUfeIf7ofgHH9KKVjVKc9QJg5UDry9aRXVUxBOSVzh9iNkUlkYHtu9x7pTDNE9xSRq/Ky2L08g5IISE42SmegKlByji4cZGsG93KJjzlGDn2BsU/oS84oWZmG/APY2ck3zKeCcopwYATCeOjmKq10E6CRUjba+mdzcSqgJdOZw2VG1R2GCvaOqS3OrMxsvRlUv++Ox++o+tTsppYeKjGm7lADqFMMn/Fdf+Ts+Z0FZrUzVD0QwooJCOElK3S6t6RJ9bQ2lFaaIiDJ7rGS5lNJMS7mKFuVrOgNbuqWWAzeUfqQCTcFhSKzPaRGr+vnPG38VXp/oo1Rhujnb9pQ44EL2cwiCnBiwoYBK1HAhDmlbRECKIgSJChRvHi5TQ8tfEuQpKbrMJFBBhb02NEBFo3fDJVhBAjgJ8xdQoQI3zP+B8PxaLIJz6YTAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTAyLTIxVDA4OjUyOjI5KzAwOjAwIu73FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wMi0yMVQwODo1MjoyOSswMDowMFOzT6gAAAAASUVORK5CYII=\"","import {\n  BLACK_JOKER,\n  CardRaw,\n  NATURAL_RANKS,\n  RED_JOKER,\n} from '../strategy/models/const'\nimport { SUITS } from '../strategy/models/Suite'\n\nconst ALL_CARDS_ONE_DECK: CardRaw[] = NATURAL_RANKS.map((rank): CardRaw[] =>\n  rank === BLACK_JOKER\n    ? [{ rank, suit: 'B' }]\n    : rank === RED_JOKER\n    ? [{ rank, suit: 'R' }]\n    : SUITS.map((suit) => ({\n        rank,\n        suit: suit.value,\n      })),\n).reduce((res, cards) => {\n  res.push(...cards)\n  return res\n}, [])\n\n/**\n * reference: https://stackoverflow.com/a/6274381\n * Shuffles array in place.\n * @param {Array} a items An array containing the items.\n */\nfunction shuffle<T>(a: T[]): T[] {\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    const x = a[i]\n    a[i] = a[j]\n    a[j] = x\n  }\n  return a\n}\n\nfunction cardCompare(a: CardRaw, b: CardRaw): number {\n  if (a.rank !== b.rank) {\n    return a.rank - b.rank\n  }\n\n  return a.suit < b.suit ? -1 : a.suit === b.suit ? 0 : 1\n}\n\nfunction cardEqual(a: CardRaw, b: CardRaw): boolean {\n  return cardCompare(a, b) === 0\n}\n\nfunction sortCards(a: CardRaw[]): CardRaw[] {\n  return a.sort(cardCompare)\n}\n\nexport function generateRandomHands(): CardRaw[] {\n  return sortCards(\n    shuffle([...ALL_CARDS_ONE_DECK, ...ALL_CARDS_ONE_DECK]).slice(0, 27),\n  )\n}\n\nexport function canIAddCard(cards: CardRaw[], cardToAdd: CardRaw): boolean {\n  return cards.filter((card) => cardEqual(card, cardToAdd)).length < 2\n}\n","import React from 'react'\nimport { View, StyleSheet } from 'react-native'\n\nconst styles = StyleSheet.create({\n  divider: {\n    height: 2, // avoid floating error\n    backgroundColor: 'black',\n    marginHorizontal: 10,\n  },\n})\n\nexport function Divider() {\n  return <View style={styles.divider} />\n}\n","import React, { FunctionComponent, ReactNode } from 'react'\nimport {\n  Text,\n  TouchableOpacity,\n  TouchableOpacityProps,\n  StyleProp,\n  TextStyle,\n} from 'react-native'\nimport { theme } from './CardsChooser'\n\ninterface MyButtonProps extends TouchableOpacityProps {\n  title: ReactNode\n  titleStyle?: StyleProp<TextStyle>\n}\n\nexport const MyButton: FunctionComponent<MyButtonProps> = ({\n  style,\n  titleStyle,\n  title,\n  disabled,\n  ...restProps\n}) => (\n  <TouchableOpacity\n    style={[\n      {\n        backgroundColor: disabled\n          ? theme.disabled.background\n          : theme.button.background,\n        borderRadius: 2,\n        paddingVertical: 8,\n        paddingHorizontal: 4,\n        alignItems: 'center',\n        justifyContent: 'center',\n      },\n      style,\n    ]}\n    disabled={disabled}\n    {...restProps}\n  >\n    <Text\n      style={[\n        {\n          color: disabled ? theme.disabled.text : 'white',\n          textAlign: 'center',\n        },\n        titleStyle,\n      ]}\n    >\n      {title}\n    </Text>\n  </TouchableOpacity>\n)\n","import React, { useCallback, useState } from 'react'\nimport {\n  ScrollView,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n} from 'react-native'\nimport { Card, CardDeck } from './Card'\nimport { canIAddCard } from './common/cardUtils'\nimport { CardState } from './common/types'\nimport { Divider } from './Divider'\nimport { MyButton } from './MyButton'\nimport {\n  A,\n  BLACK_JOKER,\n  CardRaw,\n  NaturalRank,\n  NATURAL_RANK_MAX,\n  NATURAL_RANK_MIN,\n  RED_JOKER,\n} from './strategy/models/const'\nimport {\n  AllSuit,\n  SuiteMetadata,\n  SUITS,\n  SUITS_JOKER,\n} from './strategy/models/Suite'\nimport { WindowSize } from './useWindowSize'\n\nconst palette = {\n  blue: 'rgb(33, 150, 243)',\n  grey: {\n    0: 'black',\n    4: 'rgb(161, 161, 161)',\n    6: 'rgb(223, 223, 223)',\n    8: 'white',\n  },\n}\n\nexport const theme = {\n  disabled: {\n    background: palette.grey[6],\n    text: palette.grey[4],\n  },\n  button: {\n    background: palette.blue,\n  },\n}\n\nfunction useRankState() {\n  const { value, increase, decrease } = useIncDecState(A)\n  return {\n    rank: value as NaturalRank,\n    incRank: increase,\n    decRank: decrease,\n  }\n}\n\nfunction useIncDecState(defaultValue = 0) {\n  const [value, setValue] = useState(defaultValue)\n  const increase = useCallback(() => setValue((valueNow) => valueNow + 1), [\n    setValue,\n  ])\n  const decrease = useCallback(() => setValue((valueNow) => valueNow - 1), [\n    setValue,\n  ])\n\n  return {\n    value,\n    increase,\n    decrease,\n  }\n}\n\nconst controlStyles = StyleSheet.create({\n  incDecButton: {\n    flex: 2,\n    minWidth: 80,\n    maxWidth: 200,\n    margin: 6,\n  },\n  actionButton: {\n    flex: 1,\n    minWidth: 80,\n    maxWidth: 150,\n    margin: 6,\n  },\n  buttonTitle: {\n    fontSize: 20,\n  },\n  buttonTitleSmall: {\n    fontSize: 20,\n  },\n})\ninterface ControlPanelProps {\n  decRank: () => void\n  incRank: () => void\n  clearCards: () => void\n  randomCards: () => void\n  deleteLastCard: () => void\n  rank: NaturalRank\n  numberOfCards: number\n}\nconst ControlPanel: React.FunctionComponent<ControlPanelProps> = (props) => (\n  <View>\n    <View\n      style={{\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignContent: 'center',\n      }}\n    >\n      <MyButton\n        onPress={props.decRank}\n        disabled={props.rank <= NATURAL_RANK_MIN}\n        title=\"<\"\n        style={controlStyles.incDecButton}\n        titleStyle={controlStyles.buttonTitle}\n      />\n      <MyButton\n        onPress={props.incRank}\n        title=\">\"\n        disabled={props.rank >= NATURAL_RANK_MAX}\n        style={controlStyles.incDecButton}\n        titleStyle={controlStyles.buttonTitle}\n      />\n    </View>\n    <View\n      style={{\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignContent: 'center',\n      }}\n    >\n      <MyButton\n        onPress={props.randomCards}\n        title=\"随机发牌\"\n        disabled={props.numberOfCards > 0}\n        style={controlStyles.actionButton}\n        titleStyle={controlStyles.buttonTitleSmall}\n      />\n      <MyButton\n        onPress={props.clearCards}\n        title=\"清除\"\n        disabled={props.numberOfCards === 0}\n        style={controlStyles.actionButton}\n        titleStyle={controlStyles.buttonTitle}\n      />\n      <MyButton\n        onPress={props.deleteLastCard}\n        title=\"删除\"\n        disabled={props.numberOfCards === 0}\n        style={controlStyles.actionButton}\n        titleStyle={controlStyles.buttonTitle}\n      />\n    </View>\n  </View>\n)\n\ninterface AddCardPanelProps {\n  cards: CardRaw[]\n  addCard: (card: CardRaw) => void\n  rank: NaturalRank\n  large?: boolean\n}\nconst AddCardPanel: React.FunctionComponent<AddCardPanelProps> = (props) => {\n  const suits: SuiteMetadata<AllSuit>[] =\n    props.rank === BLACK_JOKER || props.rank === RED_JOKER ? SUITS_JOKER : SUITS\n\n  return (\n    <>\n      {suits.map((suit: SuiteMetadata<AllSuit>) => {\n        const card = {\n          suit: suit.value,\n          rank: props.rank,\n        } as CardRaw\n        const canIAddThisCard = canIAddCard(props.cards, card)\n\n        return (\n          <TouchableOpacity\n            key={suit.value}\n            onPress={() => props.addCard(card)}\n            disabled={!canIAddThisCard}\n          >\n            <Card\n              suit={suit.value}\n              rank={props.rank}\n              disabled={!canIAddThisCard}\n              style={{ margin: 3 }}\n              large={props.large}\n            />\n          </TouchableOpacity>\n        )\n      })}\n    </>\n  )\n}\n\nexport function CardsChooser({\n  cards,\n  addCard,\n  clearCards,\n  randomCards,\n  deleteLastCard,\n  windowSize,\n}: CardState & {\n  windowSize: WindowSize\n}) {\n  const { rank, incRank, decRank } = useRankState()\n\n  return (\n    <View style={{ flex: 1 }}>\n      <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n        <CardDeck\n          cards={cards}\n          style={{\n            height: 60,\n            padding: 6,\n          }}\n          large={windowSize === 'BIG'}\n        />\n      </View>\n      <Divider />\n      <Text\n        style={{ fontSize: 14, margin: 4 }}\n      >{`点击扑克牌添加，目前已有${cards.length}张牌`}</Text>\n      <ScrollView\n        style={{\n          height: windowSize === 'SMALL' ? 110 : 150,\n          flexGrow: 0,\n        }}\n        contentContainerStyle={{\n          flex: 1,\n          justifyContent: 'center',\n        }}\n        horizontal\n      >\n        <AddCardPanel\n          cards={cards}\n          addCard={addCard}\n          rank={rank}\n          large={windowSize === 'BIG'}\n        />\n      </ScrollView>\n      <ControlPanel\n        numberOfCards={cards.length}\n        clearCards={clearCards}\n        randomCards={randomCards}\n        deleteLastCard={deleteLastCard}\n        rank={rank}\n        incRank={incRank}\n        decRank={decRank}\n      />\n    </View>\n  )\n}\n","import React from 'react'\nimport { View, Text, Picker } from 'react-native'\nimport { RankState } from './common/types'\nimport { SUIT } from './strategy/models/Suite'\nimport {\n  NATURAL_RANK,\n  NATURAL_RANKS_WITHOUT_JOKERS,\n} from './strategy/models/const'\n\nexport function RankChooser({ rank, setRank }: RankState) {\n  return (\n    <View\n      style={{\n        flexDirection: 'row',\n      }}\n    >\n      <Text style={{ fontSize: 22, marginHorizontal: 6 }}>\n        当前打\n        <Picker\n          selectedValue={rank}\n          onValueChange={(itemValue) => setRank(itemValue)}\n        >\n          {NATURAL_RANKS_WITHOUT_JOKERS.map((rank) => (\n            <Picker.Item\n              key={rank}\n              label={NATURAL_RANK[rank].label}\n              value={rank}\n            />\n          ))}\n        </Picker>{' '}\n        <Text style={{ color: SUIT.H.color }}>\n          {SUIT.H.label}\n          {NATURAL_RANK[rank].label}\n        </Text>\n        是百搭\n      </Text>\n    </View>\n  )\n}\n","import { GameContext } from './GameContext'\nimport { NaturalRank, PowerRank } from './const'\n\nexport interface Rank {\n  natural: NaturalRank\n  power: PowerRank\n}\n\nexport function makeRank({\n  natural,\n  context,\n}: {\n  natural: NaturalRank\n  context: GameContext\n}): Rank {\n  return {\n    natural: natural,\n    power: context.getOrder(natural),\n  }\n}\n","import { CardRaw, CardRawLoose, NATURAL_RANK } from './const'\nimport { GameContext } from './GameContext'\nimport { makeRank, Rank } from './Rank'\nimport { AllSuit, SUIT } from './Suite'\n\nexport type Card = {\n  rank: Rank\n  suit: AllSuit\n}\n\nexport function parseCardRaw(raw: CardRaw, context: GameContext): Card {\n  return {\n    rank: makeRank({ natural: raw.rank, context }),\n    suit: raw.suit,\n  }\n}\n\nexport function cardToText(card: Card): string {\n  return SUIT[card.suit].label + NATURAL_RANK[card.rank.natural].label\n}\n\nexport function cardRawToText(card: CardRaw): string {\n  return SUIT[card.suit].label + NATURAL_RANK[card.rank].label\n}\n\nexport function cardToCardRaw(card: Card): CardRaw {\n  const loose: CardRawLoose = {\n    rank: card.rank.natural,\n    suit: card.suit,\n  }\n  return loose as CardRaw\n}\n","import { Card, cardToText } from './Card'\nimport { NaturalRank, PowerRank } from './const'\n\nexport enum PlayType {\n  UNKNOWN = 0,\n  SINGLE,\n  PAIR,\n  TRIPLE,\n  FULL_HOUSE, // like 555,22\n  STRAIGHT, // like 12345\n  TUBE, // like 33,44,55\n  PLATE, // like 333,444\n  // === The following is a bomb ===\n  STRAIGHT_FLUSH, // like 34567 all hearts\n  BOMB_N_TUPLE, // like 4444, 55555, 88888888\n  FOUR_JOKER,\n}\n\nexport type PlayRankBombNTuple = {\n  type: PlayType.BOMB_N_TUPLE\n  rank: PowerRank\n  cardCount: number\n}\n\nexport type PlayRankFourJoker = {\n  type: PlayType.FOUR_JOKER\n}\n\nexport type PlayRankNormal = {\n  type: PlayType.FULL_HOUSE | PlayType.PAIR | PlayType.SINGLE | PlayType.TRIPLE\n  rank: PowerRank\n}\n\nexport type PlayRankNatural = {\n  type:\n    | PlayType.STRAIGHT_FLUSH\n    | PlayType.STRAIGHT\n    | PlayType.TUBE\n    | PlayType.PLATE\n  rank: NaturalRank\n}\n\nexport type PlayRank =\n  | PlayRankNormal\n  | PlayRankNatural\n  | PlayRankBombNTuple\n  | PlayRankFourJoker\n\nexport type Play = {\n  playRank: PlayRank\n  cards: Card[]\n}\n\nexport function playToText(play: Play): string {\n  return play.cards.map(cardToText).join('')\n}\n","import { DEBUG } from './const'\nimport { Card } from './models/Card'\nimport { A, K, NaturalRank, nextRank } from './models/const'\nimport { GameContext } from './models/GameContext'\nimport { Plan } from './models/Plan'\nimport {\n  Play,\n  PlayRankBombNTuple,\n  PlayRankNormal,\n  PlayType,\n} from './models/Play'\nimport { getNextSuit, Suit, SUIT_START } from './models/Suite'\n\nconst NEXT_PLAY_TYPE: { [T in PlayType]?: PlayType } = {\n  [PlayType.STRAIGHT_FLUSH]: PlayType.BOMB_N_TUPLE,\n  [PlayType.BOMB_N_TUPLE]: PlayType.PLATE,\n  [PlayType.PLATE]: PlayType.TUBE,\n  [PlayType.TUBE]: PlayType.STRAIGHT,\n  [PlayType.STRAIGHT]: PlayType.PAIR,\n  [PlayType.PAIR]: PlayType.TRIPLE,\n  [PlayType.TRIPLE]: undefined,\n} as const\nfunction nextPlayType(playType: PlayType): PlayType | undefined {\n  return NEXT_PLAY_TYPE[playType]\n}\ntype IteratorState = {\n  rank: NaturalRank\n  suit?: Suit\n  type: PlayType\n}\nexport const ITERATOR_STATE_START: IteratorState = {\n  rank: A,\n  suit: SUIT_START,\n  type: PlayType.STRAIGHT_FLUSH,\n}\nexport function nextIteratorState(\n  now: IteratorState,\n): IteratorState | undefined {\n  const next = nextRank(now.rank)\n  if (next != null) {\n    return {\n      ...now,\n      rank: next,\n    }\n  }\n  if (now.suit) {\n    console.assert(now.type === PlayType.STRAIGHT_FLUSH)\n    const nextSuit = getNextSuit(now.suit)\n    if (nextSuit != null) {\n      return {\n        ...now,\n        rank: A,\n        suit: nextSuit,\n      }\n    }\n  }\n  // next == null\n  const nextType = nextPlayType(now.type)\n  if (nextType != null) {\n    // Iterate the next type, and restart rank.\n    return {\n      ...now,\n      rank: A, // restart\n      type: nextType,\n      suit: undefined, // STRAIGHT_FLUSH is the only type with suit, so next type won't have suit\n    }\n  }\n  // nextType == null\n  return undefined\n}\n\nexport type PlanCollector = (plan: Plan) => void\n\nexport function iteratePlans({\n  cards,\n  collectPlan,\n  context: gameContext,\n}: {\n  cards: Card[]\n  collectPlan: PlanCollector\n  context: GameContext\n}) {\n  const cardsByRank = organize(cards, gameContext)\n  iterateImp({\n    cardsByRank,\n    context: {\n      collectPlan,\n      game: gameContext,\n      debug: DEBUG,\n    },\n  })\n}\n\ntype RankWildCard = 0\nconst WILD_CARD: RankWildCard = 0\ntype CardsByRank = { [R in NaturalRank | RankWildCard]?: Card[] }\nfunction organize(cards: Card[], context: GameContext): CardsByRank {\n  const organized: CardsByRank = {}\n  cards.forEach((card) => {\n    const rank = context.isWildCard(card) ? WILD_CARD : card.rank.natural\n    organized[rank] = organized[rank] || []\n    organized[rank]!.push(card)\n  })\n  return organized\n}\nexport const TEST_ONLY = { organize }\nfunction takeCard(\n  cards: CardsByRank, // Warning: this will mutate cards.\n  rank: NaturalRank,\n  count: number = 1,\n): Card[] | undefined {\n  console.assert(count >= 1)\n  const rankCards = cards[rank] || []\n  if (count <= rankCards.length) {\n    const taken = rankCards.slice(0, count)\n    cards[rank] = rankCards.slice(count)\n    return taken\n  }\n  const wildCards = cards[WILD_CARD]\n  const wildCardsNeeded = count - rankCards.length\n  if (!wildCards || wildCardsNeeded > wildCards.length) {\n    return undefined\n  }\n  const taken = rankCards.concat(wildCards.slice(0, wildCardsNeeded))\n  cards[rank] = []\n  cards[WILD_CARD] = wildCards.slice(wildCardsNeeded)\n  return taken\n}\nfunction takeCardBySuit(\n  cardsByRank: CardsByRank,\n  rank: NaturalRank,\n  suit: Suit,\n): Card | undefined {\n  const rankCards = cardsByRank[rank] || []\n  const index = rankCards.findIndex((card) => card.suit === suit)\n  if (index >= 0) {\n    cardsByRank[rank] = [...rankCards] // splice modifies the array, so copy it first\n    cardsByRank[rank]!.splice(index, 1)\n    return rankCards[index]\n  }\n  const wildCards = cardsByRank[WILD_CARD] || []\n  if (wildCards.length > 0) {\n    cardsByRank[WILD_CARD] = wildCards.slice(1)\n    return wildCards[0]\n  }\n  // not found\n  return undefined\n}\n\ntype IteratorContext = {\n  game: GameContext\n  collectPlan: PlanCollector\n  debug?: boolean\n}\n\ntype PlayTypeFunc = (args: {\n  cards: CardsByRank\n  nowRank: NaturalRank\n  nowSuit?: Suit\n  plan: Plan\n  context: IteratorContext\n}) => { cardsByRank: CardsByRank; plan: Plan } | undefined\nconst playCardsOfTheSameRank = (n: number): PlayTypeFunc => ({\n  cards,\n  nowRank,\n  plan,\n  context,\n}) => {\n  const newCards = { ...cards }\n  const taken = takeCard(newCards, nowRank, n)\n  if (taken == null) {\n    return undefined\n  }\n  const playRank: PlayRankBombNTuple | PlayRankNormal = {\n    type:\n      n === 2\n        ? PlayType.PAIR\n        : n === 3\n        ? PlayType.TRIPLE\n        : PlayType.BOMB_N_TUPLE,\n    rank: context.game.getOrder(nowRank),\n    cardCount: n,\n  }\n  return {\n    cardsByRank: newCards,\n    plan: {\n      score: plan.score + (n > 3 ? /* Bomb is free to play. */ 0 : 1),\n      plays: plan.plays.concat({\n        playRank,\n        cards: taken,\n      }),\n    },\n  }\n}\nconst playCardSequence = ({\n  cardCount,\n  length,\n  playType,\n}: {\n  cardCount: number\n  length: number\n  playType: PlayType.TUBE | PlayType.STRAIGHT | PlayType.PLATE\n}): PlayTypeFunc => ({ cards: cardsByRank, nowRank, plan, context }) => {\n  if (context.debug) {\n    console.log(`playCardSequence: ${JSON.stringify(cardsByRank)}, ${nowRank}`)\n  }\n  const end = nowRank + length - 1\n  if (end > K + 1) {\n    // This sequence is not possible, because it cannot go past A.\n    return undefined\n  }\n  let newCardsByRank = { ...cardsByRank }\n  let play: Play = {\n    cards: [],\n    playRank: { type: playType, rank: nowRank },\n  }\n  for (let i = nowRank; i <= end; ++i) {\n    const ii = i == K + 1 ? A : i\n    const taken = takeCard(newCardsByRank, ii, cardCount)\n    if (taken == null) {\n      return undefined\n    }\n    play.cards.push(...taken)\n  }\n  return {\n    cardsByRank: newCardsByRank,\n    plan: {\n      score: plan.score + 1,\n      plays: plan.plays.concat(play),\n    },\n  }\n}\nconst playStraightFlush: PlayTypeFunc = ({\n  cards: cardsByRank,\n  nowRank,\n  nowSuit,\n  plan,\n  context,\n}) => {\n  if (context.debug) {\n    console.log(\n      `playStraightFlush: ${JSON.stringify(\n        cardsByRank,\n      )}, ${nowRank}, ${nowSuit}`,\n    )\n  }\n  if (!nowSuit) {\n    // playStraightFlush should always be called with suit\n    console.assert(nowSuit)\n    return undefined\n  }\n  const end = nowRank + 5 - 1\n  if (end > K + 1) {\n    // This sequence is not possible, because it cannot go past A.\n    return undefined\n  }\n  let newCardsByRank = { ...cardsByRank }\n  let play: Play = {\n    cards: [],\n    playRank: { type: PlayType.STRAIGHT_FLUSH, rank: nowRank },\n  }\n  for (let i = nowRank; i <= end; ++i) {\n    const ii = i == K + 1 ? A : i\n    const taken = takeCardBySuit(newCardsByRank, ii, nowSuit)\n    if (taken == null) {\n      // not found\n      return undefined\n    }\n    play.cards.push(taken)\n  }\n  return {\n    cardsByRank: newCardsByRank,\n    plan: {\n      score: plan.score + 0, // straight flush is a bomb\n      plays: plan.plays.concat(play),\n    },\n  }\n}\nconst playPair = playCardsOfTheSameRank(2)\nconst playTriple = playCardsOfTheSameRank(3)\nconst playBomb4 = playCardsOfTheSameRank(4)\nconst playBomb5 = playCardsOfTheSameRank(5)\nconst playBomb6 = playCardsOfTheSameRank(6)\nconst playBomb7 = playCardsOfTheSameRank(7)\nconst playBomb8 = playCardsOfTheSameRank(8)\nconst playFullHouse: PlayTypeFunc = ({ cards, nowRank, plan, context }) => {\n  const result = playTriple({ cards, nowRank, plan, context })\n  if (result == null) {\n    return undefined\n  }\n  const { cardsByRank: newCards, plan: newPlan } = result\n  const pairIndex = newPlan.plays.findIndex(\n    (play) => play.playRank.type === PlayType.PAIR,\n  )\n  if (pairIndex < 0) {\n    // No pairs left, cannot make a full house.\n    return undefined\n  }\n  const triplePlay = newPlan.plays[newPlan.plays.length - 1] as Play\n  const pairPlay = newPlan.plays[pairIndex]\n  // Remove pair and triple.\n  newPlan.plays = newPlan.plays\n    .slice(0, pairIndex)\n    .concat(newPlan.plays.slice(pairIndex + 1, newPlan.plays.length - 1))\n  // Push a full house.\n  newPlan.plays.push({\n    playRank: {\n      type: PlayType.FULL_HOUSE,\n      rank: (triplePlay.playRank as PlayRankNormal).rank,\n    },\n    cards: triplePlay.cards.concat(pairPlay.cards),\n  })\n  // Pair and triple becomes a full house, one fewer hand to play.\n  newPlan.score = newPlan.score - 1\n  return { plan: newPlan, cardsByRank: newCards }\n}\nexport const playStraight = playCardSequence({\n  cardCount: 1,\n  length: 5,\n  playType: PlayType.STRAIGHT,\n})\nconst playTube = playCardSequence({\n  cardCount: 2,\n  length: 3,\n  playType: PlayType.TUBE,\n})\nconst playPlate = playCardSequence({\n  cardCount: 3,\n  length: 2,\n  playType: PlayType.PLATE,\n})\nconst PLAY_TYPE_FUNC: { [T in PlayType]?: readonly PlayTypeFunc[] } = {\n  [PlayType.PAIR]: [playPair],\n  [PlayType.TRIPLE]: [playTriple, playFullHouse],\n  [PlayType.BOMB_N_TUPLE]: [\n    playBomb4,\n    playBomb5,\n    playBomb6,\n    playBomb7,\n    playBomb8,\n  ],\n  [PlayType.STRAIGHT]: [playStraight],\n  [PlayType.TUBE]: [playTube],\n  [PlayType.PLATE]: [playPlate],\n  [PlayType.STRAIGHT_FLUSH]: [playStraightFlush],\n} as const\n\nfunction iterateImp({\n  cardsByRank,\n  plan = { score: 0, plays: [] },\n  now = ITERATOR_STATE_START,\n  context,\n}: {\n  cardsByRank: CardsByRank\n  plan?: Plan\n  now?: IteratorState\n  context: IteratorContext\n}) {\n  if (context.debug) {\n    console.log(PlayType[now.type], now.rank, now.suit)\n  }\n  PLAY_TYPE_FUNC[now.type]?.forEach((func) => {\n    const result = func({\n      nowRank: now.rank,\n      nowSuit: now.suit,\n      cards: cardsByRank,\n      plan,\n      context,\n    })\n    if (result == null) {\n      return\n    }\n    iterateImp({ ...result, now, context })\n  })\n  const next = nextIteratorState(now)\n  if (next == null) {\n    // When we reach the last iterator state, the plan is ready to collect.\n    context.collectPlan(playRestOfCardsAsSingles(plan, cardsByRank))\n    return\n  }\n  // next != null\n  iterateImp({\n    now: next,\n    cardsByRank,\n    plan,\n    context,\n  })\n}\n\nfunction playRestOfCardsAsSingles(plan: Plan, cardsByRank: CardsByRank): Plan {\n  const resultPlan = { ...plan, plays: [...plan.plays] }\n  Object.entries(cardsByRank).forEach(([_, cards]) => {\n    if (!cards) {\n      return\n    }\n    resultPlan.score += cards.length\n    cards.forEach((card) => {\n      resultPlan.plays.push({\n        playRank: {\n          type: PlayType.SINGLE,\n          rank: card.rank.power,\n        },\n        cards: [card],\n      })\n    })\n  })\n  return resultPlan\n}\n","export const DEBUG = false\nexport const MAX_PLANS = 10000000\n","import {\n  NaturalRank,\n  PowerRank,\n  RED_JOKER,\n  BLACK_JOKER,\n  A,\n} from './models/const'\n\nexport function getUsualPowerRank(rank: NaturalRank): PowerRank {\n  switch (rank) {\n    case RED_JOKER:\n      return 14\n    case BLACK_JOKER:\n      return 13\n    case A:\n      return 12\n    default:\n      return (rank - 2) as PowerRank\n  }\n}\n","import { getUsualPowerRank } from '../utils'\nimport { Card } from './Card'\nimport {\n  BLACK_JOKER,\n  NaturalRank,\n  NaturalRankWithoutJokers,\n  PowerRank,\n  RED_JOKER,\n} from './const'\n\nexport class GameContext {\n  constructor(mainRank: NaturalRankWithoutJokers) {\n    this.mainRank = mainRank\n  }\n  /** Which rank is largest in current game play. */\n  readonly mainRank: NaturalRankWithoutJokers\n  /**\n   * Returns range[0, 14], power of the rank in this gameplay.\n   * The weakest is 0. The strongest (red joker) is 14.\n   */\n  getOrder(rank: NaturalRank): PowerRank {\n    if (rank == RED_JOKER) {\n      return 14\n    } else if (rank == BLACK_JOKER) {\n      return 13\n    } else if (rank == this.mainRank) {\n      return 12\n    } else {\n      const usualRank = getUsualPowerRank(rank)\n      const mainRankUsualRank = getUsualPowerRank(this.mainRank)\n      if (usualRank > mainRankUsualRank) {\n        return (usualRank - 1) as PowerRank\n      } else {\n        return usualRank as PowerRank\n      }\n    }\n  }\n\n  isWildCard(card: Card): boolean {\n    return card.rank.natural === this.mainRank && card.suit === 'H'\n  }\n}\n","import { MAX_PLANS } from './const'\nimport { iteratePlans } from './iterate'\nimport { parseCardRaw } from './models/Card'\nimport { CardRaw, NaturalRankWithoutJokers } from './models/const'\nimport { GameContext } from './models/GameContext'\nimport { Plan } from './models/Plan'\n\nexport function calc({\n  cards: rawCards,\n  mainRank,\n}: {\n  cards: CardRaw[]\n  mainRank: NaturalRankWithoutJokers\n}): Plan[] {\n  const context = new GameContext(mainRank)\n  const cards = rawCards.map((rawCard) => parseCardRaw(rawCard, context))\n  const bestPlanCollector = makeBestPlanCollector()\n  iteratePlans({ cards, collectPlan: bestPlanCollector.collectPlan, context })\n  const bestPlan = bestPlanCollector.getBestPlan()\n  if (bestPlan == null) {\n    throw new Error('No plan found')\n  }\n  return [bestPlan]\n}\n\nconst makeBestPlanCollector = () => {\n  let bestPlan: Plan | undefined = undefined\n  let count = 0\n  return {\n    collectPlan: (plan: Plan) => {\n      if (bestPlan == null || plan.score <= bestPlan.score) {\n        bestPlan = plan\n      }\n      ++count\n      if (count > MAX_PLANS) {\n        throw new Error('too many plans')\n      }\n    },\n    getBestPlan: () => bestPlan,\n  }\n}\n","import { StyleSheet } from 'react-native';\n\nexport const commonStyles = StyleSheet.create({\n  container: {\n    padding: 10,\n  },\n  borderBox: {\n    borderWidth: 2,\n    borderColor: 'black',\n  },\n});\n","import React, { Fragment, useCallback, useState } from 'react'\nimport { View } from 'react-native'\nimport { CardsChooser } from './CardsChooser'\nimport { AppState, NavigationProps } from './common/types'\nimport { Divider } from './Divider'\nimport { MyButton } from './MyButton'\nimport { RankChooser } from './RankChooser'\nimport { cardRawToText } from './strategy/models/Card'\nimport { calc } from './strategy/strategy'\nimport { commonStyles } from './styles'\n\ninterface StatelessHomePageProps\n  extends Pick<\n      AppState,\n      | 'rank'\n      | 'setRank'\n      | 'cards'\n      | 'clearCards'\n      | 'addCard'\n      | 'randomCards'\n      | 'deleteLastCard'\n      | 'strategyResult'\n      | 'setResult'\n      | 'windowSize'\n    >,\n    Pick<NavigationProps, 'navigation'> {}\nconst HomePage: React.FunctionComponent<StatelessHomePageProps> = ({\n  rank,\n  setRank,\n  cards,\n  clearCards,\n  addCard,\n  randomCards,\n  deleteLastCard,\n  strategyResult,\n  setResult,\n  navigation,\n  windowSize,\n}) => {\n  const [useValueEstimator, setUseValueEstimator] = useState(true)\n  const handleSolutionCalcButton = useCallback(() => {\n    setResult('loading')\n\n    setTimeout(() => {\n      // console.log(cards)\n      console.log(cards.map(cardRawToText))\n      const plans = calc({ cards, mainRank: rank })\n      console.log(plans)\n      // set a minimum extra delay to avoid UI flashing too quickly\n      setTimeout(() => {\n        navigation.navigate('Result')\n        setResult(plans)\n      }, 300)\n    }, 0)\n  }, [cards, setResult, navigation, useValueEstimator])\n\n  return (\n    <Fragment>\n      <View\n        style={[\n          commonStyles.container,\n          {\n            flexDirection: 'row',\n            height: 40,\n            justifyContent: 'center',\n            alignItems: 'center',\n          },\n        ]}\n      >\n        <RankChooser rank={rank} setRank={setRank} />\n        <MyButton\n          title={useValueEstimator ? '价值' : '手数'}\n          onPress={() => setUseValueEstimator((use) => !use)}\n          titleStyle={{\n            fontSize: 18,\n          }}\n        />\n      </View>\n      <Divider />\n      <View\n        style={{\n          flex: 1,\n        }}\n      >\n        <CardsChooser\n          cards={cards}\n          addCard={addCard}\n          clearCards={clearCards}\n          randomCards={randomCards}\n          deleteLastCard={deleteLastCard}\n          windowSize={windowSize}\n        />\n      </View>\n      <View\n        style={[\n          commonStyles.container,\n          {\n            justifyContent: 'center',\n            padding: 6,\n          },\n        ]}\n      >\n        {(() => {\n          const isReady = strategyResult !== 'loading'\n          return (\n            <MyButton\n              title={isReady ? '开始拆牌' : '拆牌中...'}\n              disabled={!isReady}\n              onPress={handleSolutionCalcButton}\n              style={{\n                height: 60,\n              }}\n              titleStyle={{\n                fontSize: 28,\n              }}\n            />\n          )\n        })()}\n      </View>\n    </Fragment>\n  )\n}\n\nconst MemoedHomePage = React.memo(HomePage)\n\nfunction HomePageWrapper({ screenProps, navigation }: NavigationProps) {\n  return <MemoedHomePage {...screenProps} navigation={navigation} />\n}\n\nexport default HomePageWrapper\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0V0z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z\"\n});\n\nfunction SvgClose(_ref, svgRef) {\n  let title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3);\n}\n\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgClose);\nexport default __webpack_public_path__ + \"static/media/close.2c0e4ee3.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0V0z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"\n});\n\nfunction SvgInfo(_ref, svgRef) {\n  let title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3);\n}\n\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgInfo);\nexport default __webpack_public_path__ + \"static/media/info.8bfd8780.svg\";\nexport { ForwardRef as ReactComponent };","import React, { memo } from 'react'\nimport {\n  View,\n  Text,\n  ScrollView,\n  TouchableOpacity,\n  StyleProp,\n  ViewStyle,\n} from 'react-native'\nimport { Divider } from './Divider'\nimport { CardDeck } from './Card'\nimport { commonStyles } from './styles'\nimport { StrategyResultState } from './useResultState'\nimport { ReactComponent as Close } from './icons/close.svg'\nimport { ReactComponent as Info } from './icons/info.svg'\nimport { WindowSize } from './useWindowSize'\nimport { NaturalRankWithoutJokers } from './strategy/models/const'\nimport { cardToCardRaw } from './strategy/models/Card'\n\ninterface SolutionVisualizationProps {\n  strategyResult: StrategyResultState\n  rank: NaturalRankWithoutJokers\n  windowSize: WindowSize\n  onClose: () => void\n}\n\ninterface WindowSizeToggleProps {\n  onClose: () => void\n  style: StyleProp<ViewStyle>\n}\nconst CloseWindowButton: React.FunctionComponent<WindowSizeToggleProps> = (\n  props,\n) => (\n  <TouchableOpacity\n    style={[\n      {\n        width: 40,\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignItems: 'center',\n      },\n      props.style,\n    ]}\n    onPress={props.onClose}\n  >\n    <Close />\n  </TouchableOpacity>\n)\n\ninterface SolutionWindowProps {\n  rank: NaturalRankWithoutJokers\n  strategyResult: StrategyResultState\n  windowSize: WindowSize\n}\nconst SolutionWindow: React.FunctionComponent<SolutionWindowProps> = ({\n  strategyResult,\n  rank,\n  windowSize,\n}) => (\n  <ScrollView\n    style={[\n      commonStyles.container,\n      {\n        flex: 2,\n      },\n    ]}\n  >\n    {strategyResult &&\n      (strategyResult === 'loading' ? (\n        <Text\n          style={{\n            fontSize: 20,\n          }}\n        >\n          {/* 计算中... */}\n        </Text>\n      ) : (\n        <>\n          <View\n            style={{\n              flexDirection: 'row',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n            }}\n          >\n            <Text\n              style={{ fontSize: 18, flexShrink: 0, marginRight: 20 }}\n            >{`最少${strategyResult[0].score}手牌`}</Text>\n            <Text style={{ textAlignVertical: 'center' }}>\n              <Info style={{ width: 19, height: 19, verticalAlign: 'top' }} />\n              大小王、炸弹算0手，其他牌型算1手\n            </Text>\n          </View>\n          <View>\n            {(() => {\n              const solutionsCount = strategyResult.length\n              const hiddenMoreSolutions = solutionsCount - 10\n              return (\n                <>\n                  {strategyResult.slice(0, 10).map((plan, planIndex) => (\n                    <CardDeck\n                      key={planIndex}\n                      hands={plan.plays.map((play) =>\n                        play.cards.map(cardToCardRaw),\n                      )}\n                      style={{\n                        margin: 6,\n                      }}\n                      large={windowSize === 'BIG'}\n                    />\n                  ))}\n                  {hiddenMoreSolutions > 0 &&\n                    `还有${hiddenMoreSolutions}种方案可以达到同样的最少手数`}\n                </>\n              )\n            })()}\n          </View>\n        </>\n      ))}\n  </ScrollView>\n)\nconst MemoedSolutionWindow = memo(SolutionWindow)\n\nconst SolutionVisualization: React.FunctionComponent<SolutionVisualizationProps> = ({\n  strategyResult,\n  rank,\n  onClose,\n  windowSize,\n}) => (\n  <>\n    <View\n      style={{\n        flexDirection: 'row',\n        justifyContent: 'flex-end',\n        alignContent: 'center',\n      }}\n    >\n      <View style={{ flex: 1 }}>\n        <Text\n          style={{\n            fontSize: 20,\n            padding: 4,\n            textAlign: 'center',\n          }}\n        >\n          拆牌策略计算结果\n        </Text>\n      </View>\n      {/* <View style={{ width: 2, backgroundColor: 'black' }} /> */}\n      <CloseWindowButton\n        onClose={onClose}\n        style={{\n          // to the right and centered\n          position: 'absolute',\n          right: 0,\n          height: '100%',\n        }}\n      />\n    </View>\n    <Divider />\n    <MemoedSolutionWindow\n      strategyResult={strategyResult}\n      rank={rank}\n      windowSize={windowSize}\n    />\n  </>\n)\n\nexport default React.memo(SolutionVisualization)\n","import React from 'react'\nimport { NavigationProps } from './common/types'\nimport SolutionVisualization from './SolutionVisualization'\n\nfunction ResultPage({ screenProps, navigation }: NavigationProps) {\n  const { strategyResult, rank, windowSize } = screenProps\n\n  return (\n    <SolutionVisualization\n      strategyResult={strategyResult}\n      rank={rank}\n      windowSize={windowSize}\n      onClose={navigation.goBack}\n    />\n  )\n}\nexport default ResultPage\n","import { useState, useMemo, useEffect, useCallback } from 'react'\nimport { History } from 'history'\n\n// using internal state\nexport function useRouterState(defaultRoute: string) {\n  const [route, navigate] = useState(defaultRoute)\n  const navigation = useMemo(\n    () => ({\n      navigate,\n    }),\n    [navigate],\n  )\n  return {\n    route,\n    navigation,\n  }\n}\n\ninterface RouteConfig {\n  path: string\n  title: string\n}\n\ninterface RoutesConfig {\n  base: string\n  defaultRoute: string\n  routes: {\n    [route: string]: RouteConfig\n  }\n}\n\nexport const NOT_FOUND = 'NOT_FOUND'\nconst NOT_FOUND_CONFIG: RouteConfig = {\n  path: '/not-found',\n  title: 'Page Not Found',\n}\n\n// remove ending /\nfunction normalizePath(path: string) {\n  if (path.endsWith('/')) {\n    return path.substring(0, path.length - 1)\n  }\n\n  return path\n}\n\nexport function createBrowserRouterHook(\n  providedRoutesConfig: RoutesConfig,\n  history: History,\n) {\n  const routesConfig: RoutesConfig = {\n    ...providedRoutesConfig,\n    routes: { ...providedRoutesConfig.routes, [NOT_FOUND]: NOT_FOUND_CONFIG },\n  }\n  function getCurrentPath() {\n    const pathNowRaw = history.location.pathname\n    if (pathNowRaw.startsWith(routesConfig.base)) {\n      return normalizePath(pathNowRaw.substring(routesConfig.base.length))\n    }\n\n    return routesConfig.base + NOT_FOUND_CONFIG.path\n  }\n  function match(pathname: string) {\n    const [route, routeConfig] = Object.entries(routesConfig.routes).find(\n      ([_, routeConfig]) => routeConfig.path === pathname,\n    ) || [NOT_FOUND, NOT_FOUND_CONFIG]\n\n    return {\n      route,\n      routeConfig,\n    }\n  }\n\n  return function useBrowserRouterState() {\n    const [route, setRoute] = useState(match(getCurrentPath()).route)\n\n    useEffect(() => {\n      function historyEventHandler(location: any, action: any) {\n        // console.log(location)\n        // console.log(action)\n        // console.log(getCurrentPath())\n        // console.log(match(getCurrentPath()))\n        setRoute(match(getCurrentPath()).route)\n      }\n\n      // listen for all incoming navigations, returns function to unlisten the event handler\n      return history.listen(historyEventHandler)\n    }, [setRoute])\n\n    useEffect(() => {\n      window.document.title = routesConfig.routes[route].title\n    }, [])\n\n    // dispatch navigation action\n    const navigate = useCallback(\n      (routeToDispatch, { replace = false } = {}) => {\n        // check validity of the route, if not found, go to the NOT_FOUND page\n        routeToDispatch = routesConfig.routes[routeToDispatch]\n          ? routeToDispatch\n          : NOT_FOUND\n        const routeMatched = routesConfig.routes[routeToDispatch]\n\n        if (replace) {\n          history.replace(routesConfig.base + routeMatched.path)\n        } else {\n          history.push(routesConfig.base + routeMatched.path)\n        }\n      },\n      [routesConfig, NOT_FOUND_CONFIG],\n    )\n\n    return {\n      route,\n      title: routesConfig.routes[route].title,\n      navigation: {\n        navigate,\n        goBack: history.goBack,\n      },\n    }\n  }\n}\n","import { useState, useEffect } from 'react'\nimport { Dimensions } from 'react-native'\n\nexport type WindowSize = 'BIG' | 'SMALL'\nconst LARGE_SCREEN_LENGTH = 720\n\nfunction calcWindowSize(): WindowSize {\n  const { width, height } = Dimensions.get('window')\n  return width >= LARGE_SCREEN_LENGTH && height >= LARGE_SCREEN_LENGTH\n    ? 'BIG'\n    : 'SMALL'\n}\n\nexport function useWindowSize() {\n  const [size, setSize] = useState<WindowSize>(calcWindowSize)\n  useEffect(() => {\n    function handleWindowSizeChange() {\n      setSize(calcWindowSize())\n    }\n    Dimensions.addEventListener('change', handleWindowSizeChange)\n    // unsubscribe when effect destroyed\n    return () =>\n      Dimensions.removeEventListener('change', handleWindowSizeChange)\n  }, [setSize])\n  return size\n}\n","/// <reference path=\"lib.d.ts\"/>\n\nimport createHistory from 'history/createBrowserHistory'\nimport React, { FunctionComponent, useState } from 'react'\nimport { StyleProp, StyleSheet, Text, View, ViewStyle } from 'react-native'\nimport { TransitionGroup } from 'react-transition-group'\nimport { NavigationProps } from './common/types'\nimport { Fade } from './Fade'\nimport Home from './Home'\nimport ResultPage from './ResultPage'\nimport { A, NaturalRankWithoutJokers } from './strategy/models/const'\nimport { useCardState } from './useCardState'\nimport { useResultState } from './useResultState'\nimport { createBrowserRouterHook } from './useRouterState'\nimport { useWindowSize } from './useWindowSize'\n\ninterface AppNavigatorProps extends NavigationProps {\n  route: string\n  style?: StyleProp<ViewStyle>\n}\nconst styles = StyleSheet.create({\n  absoluteChild: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    right: 0,\n    bottom: 0,\n  },\n})\n\nconst routes = {\n  Home,\n  Result: ResultPage,\n}\nconst AppNavigator: FunctionComponent<AppNavigatorProps> = ({\n  route: currentRoute,\n  navigation,\n  screenProps,\n  style,\n}) => {\n  return (\n    <>\n      <TransitionGroup>\n        {Object.entries(routes).map(([route, RouteComponent]) => {\n          if (route !== currentRoute) return null\n\n          return (\n            <Fade\n              key={route}\n              style={[styles.absoluteChild, style]}\n              timeout={300}\n            >\n              <RouteComponent\n                screenProps={screenProps}\n                navigation={navigation}\n              />\n            </Fade>\n          )\n        })}\n      </TransitionGroup>\n    </>\n  )\n}\n\nconst routesConfig = {\n  base: process.env.REACT_APP_BASE_URL || '',\n  defaultRoute: 'Home',\n  routes: {\n    Home: {\n      path: '',\n      title: '掼蛋拆牌计算器',\n    },\n    Result: {\n      path: '/result',\n      title: '掼蛋拆牌计算器',\n    },\n  },\n}\nconst history = createHistory()\n\nconst useRouterState = createBrowserRouterHook(routesConfig, history)\n\nfunction App() {\n  const [rank, setRank] = useState<NaturalRankWithoutJokers>(A)\n  const cardStateProps = useCardState()\n  const resultProps = useResultState()\n  const { route, navigation } = useRouterState()\n  const windowSize = useWindowSize()\n\n  return (\n    <View\n      style={{\n        flex: 1,\n        backgroundColor: 'lightblue',\n        height: '100%',\n      }}\n    >\n      <View style={{ height: '100%' }}>\n        <Text style={{ fontSize: 14 }}>掼蛋拆牌计算器</Text>\n        <View style={{ flex: 1 }}>\n          <AppNavigator\n            route={route}\n            screenProps={{\n              rank,\n              setRank,\n              ...cardStateProps,\n              ...resultProps,\n              windowSize,\n            }}\n            navigation={navigation}\n            style={{\n              flex: 1,\n            }}\n          />\n        </View>\n      </View>\n    </View>\n  )\n}\n\nexport default App\n","import { useCallback, useState } from 'react'\nimport { generateRandomHands } from './common/cardUtils'\nimport { CardState } from './common/types'\nimport { CardRaw } from './strategy/models/const'\n\nexport function useCardState(): CardState {\n  const [cards, setCards] = useState<CardRaw[]>([])\n  const clearCards = useCallback(() => setCards([]), [setCards])\n  const addCard = useCallback(\n    (card) => setCards((cardsNow) => cardsNow.concat(card)),\n    [setCards],\n  )\n  const randomCards = useCallback(() => setCards(generateRandomHands()), [\n    setCards,\n  ])\n  const deleteLastCard = useCallback(\n    () => setCards((cardsNow) => cardsNow.slice(0, cardsNow.length - 1)),\n    [setCards],\n  )\n  return {\n    cards,\n    clearCards,\n    addCard,\n    randomCards,\n    deleteLastCard,\n  }\n}\n","import { useState } from 'react'\nimport { Plan } from './strategy/models/Plan'\n\nexport type StrategyResultState = null | 'loading' | Plan[]\nexport interface ResultProps {\n  strategyResult: StrategyResultState\n  setResult: (result: StrategyResultState) => void\n}\nexport const useResultState = () => {\n  const [strategyResult, setResult] = useState<StrategyResultState>(null)\n  return {\n    strategyResult,\n    setResult,\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { AppRegistry } from 'react-native'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nAppRegistry.registerComponent('App', () => App)\nAppRegistry.runApplication('App', {\n  rootTag: document.getElementById('root'),\n})\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register({\n  onSuccess: () => console.log('service worker loaded successfully'),\n  onUpdate: () => console.log('service worker is updated'),\n})\n\nfunction removeWechatGuidance() {\n  const guidanceNode = window.document.getElementById('wechat-guidance')\n  if (guidanceNode) {\n    const parentNode = guidanceNode.parentNode\n    if (parentNode) {\n      parentNode.removeChild(guidanceNode)\n    }\n  }\n}\n\nremoveWechatGuidance()\n"],"sourceRoot":""}